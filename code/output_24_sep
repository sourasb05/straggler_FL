----------Experiment---------
Namespace(dataset='mnist', epoch=30, frac=0.3, gpu=None, iid=0, kernel_num=9, kernel_sizes='3,4,5', l_batch=128, l_epoch=50, lr=0.01, max_pool='True', method='fedavg', model='cnn', n_classes=10, n_equal=0, norm='batch_norm', num_channels=1, num_filters=32, num_users=100, optimizer='sgd', seed=0, stop=3, straggler_frac=0.9, user_type=0, verbose=1)
 Model : cnn

 Optimizer : sgd
 learning rate : 0.01
 Global Rounds : 30
 Federated settings
Dataset : IID
Fraction of participating users: 0.3
Local batch size: 128
Local epochs: 50
straggler_frac: 0.9

 | Global Training Round : 1 |

len idxs_epoch 10
idxs_epoch [50, 3, 24, 3, 11, 19, 18, 24, 17, 16, 12, 18, 5, 3, 15, 50, 9, 5, 15, 15, 7, 24, 10, 5, 20, 3, 2, 19, 23, 10, 16, 15, 8, 13, 23, 1, 8, 1, 20, 50, 25, 24, 18, 4, 19, 11, 6, 13, 8, 20, 3, 24, 10, 14, 50, 15, 50, 5, 6, 5, 1, 11, 12, 3, 15, 50, 2, 24, 5, 21, 11, 16, 9, 12, 24, 24, 19, 50, 8, 10, 24, 18, 18, 14, 11, 50, 22, 50, 19, 6, 17, 20, 11, 4, 9, 7, 50, 19, 14, 17]
len_epoch: 100
 
Avg validation Stats after 1 global rounds:
Validation Loss : 2.039523463606835
Validation Accuracy: 61.72% 

Validation loss decreased (inf --> 2.039523).  Saving model ...

 | Global Training Round : 2 |

len idxs_epoch 10
idxs_epoch [25, 17, 11, 50, 1, 14, 11, 14, 16, 13, 3, 22, 50, 14, 50, 9, 21, 24, 3, 19, 4, 14, 21, 20, 2, 11, 50, 6, 10, 18, 24, 9, 2, 16, 50, 10, 17, 19, 15, 12, 1, 2, 12, 4, 22, 12, 2, 10, 9, 12, 7, 12, 19, 20, 13, 17, 3, 2, 15, 8, 23, 19, 23, 2, 12, 13, 8, 7, 16, 18, 20, 13, 2, 17, 16, 5, 50, 24, 18, 50, 9, 24, 10, 20, 21, 11, 5, 5, 20, 50, 5, 23, 50, 14, 6, 22, 50, 17, 20, 24]
len_epoch: 100
 
Avg validation Stats after 2 global rounds:
Validation Loss : 0.9956280555129052
Validation Accuracy: 84.05% 

Validation loss decreased (2.039523 --> 0.995628).  Saving model ...

 | Global Training Round : 3 |

len idxs_epoch 10
idxs_epoch [11, 23, 21, 50, 16, 50, 50, 22, 24, 25, 25, 25, 11, 6, 18, 17, 2, 22, 14, 3, 10, 25, 7, 21, 14, 12, 23, 1, 50, 14, 17, 11, 16, 17, 14, 24, 3, 1, 24, 6, 15, 13, 19, 18, 10, 24, 18, 1, 17, 50, 18, 24, 21, 13, 4, 3, 7, 13, 24, 9, 20, 13, 17, 7, 50, 5, 17, 14, 10, 16, 50, 50, 20, 7, 19, 50, 15, 11, 17, 11, 20, 11, 6, 12, 19, 5, 1, 18, 2, 1, 21, 6, 4, 11, 3, 21, 10, 50, 4, 16]
len_epoch: 100
 
Avg validation Stats after 3 global rounds:
Validation Loss : 0.5119131971001625
Validation Accuracy: 88.25% 

Validation loss decreased (0.995628 --> 0.511913).  Saving model ...

 | Global Training Round : 4 |

len idxs_epoch 10
idxs_epoch [22, 12, 24, 16, 19, 8, 19, 12, 10, 2, 3, 2, 50, 4, 19, 1, 4, 9, 9, 18, 10, 15, 10, 5, 20, 13, 19, 25, 11, 6, 50, 16, 16, 4, 2, 7, 17, 50, 14, 24, 25, 6, 16, 20, 13, 18, 13, 23, 7, 23, 1, 50, 12, 12, 19, 24, 11, 23, 25, 2, 11, 8, 15, 17, 50, 20, 19, 9, 1, 50, 12, 4, 14, 50, 9, 7, 25, 24, 21, 20, 19, 21, 16, 19, 2, 50, 13, 11, 12, 50, 13, 11, 7, 50, 12, 3, 1, 24, 4, 17]
len_epoch: 100
 
Avg validation Stats after 4 global rounds:
Validation Loss : 0.4007868172973395
Validation Accuracy: 89.87% 

Validation loss decreased (0.511913 --> 0.400787).  Saving model ...

 | Global Training Round : 5 |

len idxs_epoch 10
idxs_epoch [11, 17, 4, 3, 12, 25, 24, 16, 8, 7, 1, 9, 25, 17, 20, 19, 50, 12, 19, 20, 9, 19, 12, 7, 21, 18, 50, 1, 12, 10, 50, 20, 25, 2, 50, 15, 13, 8, 15, 16, 8, 7, 22, 16, 25, 50, 6, 11, 24, 24, 20, 1, 16, 16, 1, 16, 7, 5, 5, 1, 18, 3, 50, 13, 19, 9, 5, 7, 20, 5, 25, 14, 8, 18, 13, 18, 25, 15, 8, 20, 3, 18, 50, 6, 8, 10, 17, 50, 18, 9, 23, 21, 3, 1, 14, 5, 18, 20, 50, 50]
len_epoch: 100
 
Avg validation Stats after 5 global rounds:
Validation Loss : 0.32617488318495447
Validation Accuracy: 91.43% 

Validation loss decreased (0.400787 --> 0.326175).  Saving model ...

 | Global Training Round : 6 |

len idxs_epoch 10
idxs_epoch [10, 18, 4, 5, 5, 6, 2, 13, 16, 9, 50, 14, 4, 21, 25, 14, 15, 22, 17, 18, 16, 16, 50, 11, 24, 10, 14, 18, 19, 19, 7, 16, 11, 50, 13, 10, 22, 1, 9, 22, 8, 3, 50, 13, 14, 19, 11, 3, 2, 6, 50, 1, 6, 17, 1, 24, 20, 50, 14, 1, 18, 2, 17, 50, 20, 5, 15, 6, 3, 21, 4, 4, 23, 19, 24, 24, 8, 19, 16, 50, 24, 3, 4, 17, 50, 50, 2, 17, 4, 22, 9, 20, 17, 1, 10, 12, 10, 11, 17, 7]
len_epoch: 100
 
Avg validation Stats after 6 global rounds:
Validation Loss : 0.28784559295512735
Validation Accuracy: 92.03% 

Validation loss decreased (0.326175 --> 0.287846).  Saving model ...

 | Global Training Round : 7 |

len idxs_epoch 10
idxs_epoch [16, 15, 20, 10, 19, 11, 20, 18, 8, 23, 3, 23, 19, 13, 2, 50, 20, 12, 22, 24, 24, 12, 14, 16, 11, 21, 8, 2, 1, 15, 12, 8, 16, 8, 14, 20, 10, 2, 6, 50, 2, 14, 50, 3, 23, 12, 20, 12, 23, 12, 3, 23, 15, 7, 16, 18, 50, 6, 21, 1, 14, 23, 2, 12, 9, 10, 20, 17, 15, 5, 3, 50, 13, 6, 13, 10, 15, 50, 9, 13, 50, 12, 20, 10, 17, 11, 50, 50, 14, 17, 14, 50, 12, 5, 2, 4, 7, 21, 21, 15]
len_epoch: 100
 
Avg validation Stats after 7 global rounds:
Validation Loss : 0.25947773011820396
Validation Accuracy: 92.62% 

Validation loss decreased (0.287846 --> 0.259478).  Saving model ...

 | Global Training Round : 8 |

len idxs_epoch 10
idxs_epoch [7, 10, 50, 7, 16, 6, 1, 10, 22, 6, 9, 1, 20, 25, 22, 19, 25, 12, 9, 19, 50, 21, 8, 50, 17, 18, 50, 50, 50, 19, 16, 20, 6, 2, 2, 50, 2, 23, 6, 7, 6, 9, 24, 20, 10, 2, 20, 22, 4, 5, 10, 8, 24, 24, 2, 1, 3, 19, 11, 11, 24, 11, 17, 17, 3, 7, 11, 2, 10, 13, 2, 23, 13, 5, 24, 50, 1, 6, 50, 16, 4, 8, 8, 10, 10, 13, 9, 3, 15, 50, 20, 14, 5, 16, 21, 14, 18, 20, 14, 5]
len_epoch: 100
 
Avg validation Stats after 8 global rounds:
Validation Loss : 0.23972178337280642
Validation Accuracy: 93.13% 

Validation loss decreased (0.259478 --> 0.239722).  Saving model ...

 | Global Training Round : 9 |

len idxs_epoch 10
idxs_epoch [11, 13, 8, 12, 50, 23, 1, 14, 16, 20, 50, 3, 21, 19, 12, 15, 19, 8, 10, 2, 11, 18, 18, 2, 1, 50, 18, 13, 22, 23, 4, 4, 50, 12, 21, 11, 3, 10, 50, 25, 14, 17, 19, 5, 25, 12, 6, 50, 4, 24, 16, 6, 7, 8, 15, 17, 24, 19, 50, 1, 50, 22, 18, 10, 11, 9, 17, 16, 21, 2, 6, 6, 10, 7, 22, 17, 5, 15, 23, 22, 2, 7, 20, 1, 9, 13, 50, 22, 3, 25, 17, 50, 2, 9, 14, 23, 17, 10, 11, 21]
len_epoch: 100
 
Avg validation Stats after 9 global rounds:
Validation Loss : 0.22245807118364605
Validation Accuracy: 93.62% 

Validation loss decreased (0.239722 --> 0.222458).  Saving model ...

 | Global Training Round : 10 |

len idxs_epoch 10
idxs_epoch [2, 4, 22, 50, 5, 5, 50, 13, 25, 25, 21, 25, 14, 20, 1, 3, 13, 13, 50, 18, 14, 50, 50, 20, 50, 50, 15, 13, 6, 12, 11, 20, 18, 11, 12, 20, 15, 13, 5, 6, 4, 25, 18, 16, 19, 50, 13, 3, 13, 8, 5, 3, 20, 4, 13, 8, 24, 2, 1, 13, 2, 22, 7, 17, 25, 50, 50, 5, 10, 4, 7, 18, 16, 8, 13, 14, 14, 19, 20, 25, 1, 1, 23, 12, 21, 1, 8, 2, 23, 24, 19, 25, 10, 12, 9, 11, 4, 24, 4, 1]
len_epoch: 100
 
Avg validation Stats after 10 global rounds:
Validation Loss : 0.20892685684131002
Validation Accuracy: 93.90% 

Validation loss decreased (0.222458 --> 0.208927).  Saving model ...

 | Global Training Round : 11 |

len idxs_epoch 10
idxs_epoch [21, 24, 12, 11, 17, 5, 19, 50, 3, 23, 15, 50, 7, 2, 50, 13, 8, 19, 16, 12, 1, 18, 20, 14, 2, 2, 4, 9, 19, 24, 50, 6, 25, 19, 4, 3, 3, 8, 14, 13, 25, 19, 12, 22, 7, 18, 7, 8, 5, 24, 10, 1, 25, 8, 50, 25, 11, 9, 3, 8, 22, 5, 15, 22, 14, 18, 6, 7, 15, 14, 22, 4, 50, 8, 19, 23, 22, 50, 50, 17, 9, 24, 7, 13, 50, 5, 4, 50, 12, 10, 21, 14, 18, 5, 11, 6, 8, 15, 18, 2]
len_epoch: 100
 
Avg validation Stats after 11 global rounds:
Validation Loss : 0.19727971994632398
Validation Accuracy: 94.08% 

Validation loss decreased (0.208927 --> 0.197280).  Saving model ...

 | Global Training Round : 12 |

len idxs_epoch 10
idxs_epoch [25, 5, 50, 5, 50, 5, 9, 22, 11, 50, 20, 5, 15, 50, 16, 20, 5, 1, 2, 7, 6, 9, 18, 50, 50, 19, 21, 13, 23, 19, 18, 20, 3, 6, 17, 21, 21, 15, 3, 24, 25, 19, 19, 21, 50, 12, 9, 18, 6, 7, 11, 9, 15, 17, 2, 16, 20, 14, 50, 6, 13, 21, 2, 17, 21, 21, 50, 11, 14, 1, 13, 14, 3, 8, 7, 2, 1, 3, 7, 13, 50, 18, 17, 19, 7, 25, 18, 22, 9, 11, 4, 19, 16, 17, 14, 25, 23, 4, 16, 25]
len_epoch: 100
 
Avg validation Stats after 12 global rounds:
Validation Loss : 0.18892805855046016
Validation Accuracy: 94.35% 

Validation loss decreased (0.197280 --> 0.188928).  Saving model ...

 | Global Training Round : 13 |

len idxs_epoch 10
idxs_epoch [15, 12, 24, 7, 12, 24, 16, 23, 11, 7, 24, 50, 16, 3, 11, 20, 1, 20, 21, 18, 22, 50, 5, 8, 24, 50, 16, 14, 14, 2, 9, 14, 22, 20, 13, 22, 5, 19, 25, 1, 50, 10, 1, 21, 50, 17, 12, 9, 21, 2, 14, 50, 20, 12, 4, 20, 1, 1, 4, 12, 4, 23, 50, 3, 50, 11, 25, 9, 6, 2, 2, 15, 18, 20, 1, 7, 12, 18, 15, 4, 20, 50, 12, 21, 18, 23, 19, 3, 13, 10, 18, 24, 6, 25, 19, 50, 15, 5, 12, 19]
len_epoch: 100
 
Avg validation Stats after 13 global rounds:
Validation Loss : 0.1817462991158245
Validation Accuracy: 94.73% 

Validation loss decreased (0.188928 --> 0.181746).  Saving model ...

 | Global Training Round : 14 |

len idxs_epoch 10
idxs_epoch [5, 12, 22, 10, 4, 5, 20, 18, 6, 12, 50, 21, 13, 11, 10, 17, 5, 50, 3, 18, 9, 5, 50, 10, 6, 21, 18, 17, 22, 1, 11, 13, 6, 7, 20, 13, 3, 18, 9, 50, 7, 20, 11, 15, 18, 18, 6, 15, 7, 22, 20, 50, 16, 20, 16, 14, 19, 50, 10, 6, 22, 3, 5, 24, 9, 22, 9, 23, 3, 21, 23, 5, 23, 20, 50, 17, 50, 5, 7, 18, 5, 6, 4, 7, 11, 13, 17, 19, 16, 50, 3, 22, 8, 15, 4, 18, 11, 19, 50, 22]
len_epoch: 100
 
Avg validation Stats after 14 global rounds:
Validation Loss : 0.17406603891006678
Validation Accuracy: 94.73% 

Validation loss decreased (0.181746 --> 0.174066).  Saving model ...

 | Global Training Round : 15 |

len idxs_epoch 10
idxs_epoch [1, 23, 50, 5, 15, 15, 23, 22, 13, 50, 17, 16, 10, 1, 12, 6, 5, 25, 50, 3, 50, 9, 20, 18, 11, 17, 7, 11, 15, 8, 10, 50, 9, 2, 6, 23, 10, 18, 16, 7, 7, 15, 21, 12, 22, 6, 4, 4, 2, 9, 25, 24, 12, 23, 22, 15, 22, 7, 6, 15, 50, 2, 16, 25, 20, 17, 8, 9, 4, 15, 17, 16, 50, 20, 14, 20, 7, 12, 50, 7, 11, 22, 50, 13, 13, 50, 13, 10, 4, 16, 14, 18, 3, 22, 2, 23, 13, 1, 25, 19]
len_epoch: 100
 
Avg validation Stats after 15 global rounds:
Validation Loss : 0.16727305452185098
Validation Accuracy: 95.05% 

Validation loss decreased (0.174066 --> 0.167273).  Saving model ...

 | Global Training Round : 16 |

len idxs_epoch 10
idxs_epoch [16, 16, 3, 4, 10, 11, 19, 20, 19, 12, 50, 24, 2, 9, 22, 2, 17, 50, 17, 14, 16, 10, 18, 10, 50, 16, 5, 23, 14, 16, 24, 14, 25, 24, 50, 19, 50, 25, 8, 11, 6, 8, 5, 19, 50, 4, 19, 19, 8, 3, 15, 4, 15, 50, 6, 2, 25, 9, 22, 18, 15, 50, 25, 20, 20, 2, 3, 24, 19, 50, 18, 23, 12, 15, 4, 16, 9, 15, 14, 5, 18, 6, 5, 4, 15, 3, 14, 11, 9, 20, 13, 25, 1, 18, 9, 50, 15, 1, 22, 16]
len_epoch: 100
 
Avg validation Stats after 16 global rounds:
Validation Loss : 0.16105171209285618
Validation Accuracy: 95.22% 

Validation loss decreased (0.167273 --> 0.161052).  Saving model ...

 | Global Training Round : 17 |

len idxs_epoch 10
idxs_epoch [6, 18, 9, 50, 10, 50, 25, 18, 18, 21, 10, 23, 7, 10, 1, 25, 4, 23, 2, 24, 1, 3, 1, 10, 4, 25, 2, 2, 14, 6, 12, 17, 12, 5, 14, 14, 3, 17, 13, 2, 24, 19, 22, 19, 6, 25, 1, 10, 8, 17, 18, 50, 4, 18, 25, 9, 23, 50, 4, 22, 17, 15, 6, 13, 1, 25, 3, 50, 18, 15, 20, 18, 50, 24, 18, 1, 11, 20, 13, 17, 13, 23, 9, 21, 50, 18, 4, 13, 13, 4, 14, 11, 25, 50, 15, 10, 50, 15, 10, 50]
len_epoch: 100
 
Avg validation Stats after 17 global rounds:
Validation Loss : 0.15469708941984572
Validation Accuracy: 95.33% 

Validation loss decreased (0.161052 --> 0.154697).  Saving model ...

 | Global Training Round : 18 |

len idxs_epoch 10
idxs_epoch [20, 19, 13, 9, 3, 22, 22, 8, 9, 22, 21, 12, 4, 16, 20, 7, 8, 50, 1, 18, 50, 3, 14, 15, 3, 50, 8, 11, 50, 25, 20, 9, 11, 22, 4, 23, 25, 24, 21, 2, 2, 25, 14, 6, 21, 18, 22, 16, 9, 1, 20, 19, 19, 23, 17, 10, 3, 12, 18, 12, 22, 7, 16, 8, 7, 24, 18, 1, 10, 21, 5, 24, 25, 12, 50, 21, 25, 10, 19, 50, 7, 1, 1, 50, 5, 3, 19, 20, 14, 3, 7, 15, 7, 50, 50, 22, 24, 3, 50, 6]
len_epoch: 100
 
Avg validation Stats after 18 global rounds:
Validation Loss : 0.14821947951869516
Validation Accuracy: 95.53% 

Validation loss decreased (0.154697 --> 0.148219).  Saving model ...

 | Global Training Round : 19 |

len idxs_epoch 10
idxs_epoch [50, 5, 22, 50, 9, 1, 7, 50, 13, 14, 1, 50, 17, 20, 12, 11, 7, 14, 16, 2, 9, 16, 10, 11, 9, 7, 20, 22, 9, 12, 20, 50, 10, 23, 15, 20, 20, 5, 5, 16, 7, 12, 25, 19, 18, 10, 6, 14, 9, 50, 3, 17, 22, 23, 6, 24, 12, 5, 13, 13, 50, 9, 15, 6, 16, 22, 19, 17, 7, 20, 23, 50, 15, 1, 21, 15, 21, 8, 12, 21, 5, 4, 1, 12, 50, 7, 4, 11, 24, 13, 7, 13, 6, 50, 8, 14, 15, 22, 1, 9]
len_epoch: 100
 
Avg validation Stats after 19 global rounds:
Validation Loss : 0.14452681796587424
Validation Accuracy: 95.68% 

Validation loss decreased (0.148219 --> 0.144527).  Saving model ...

 | Global Training Round : 20 |

len idxs_epoch 10
idxs_epoch [11, 9, 4, 50, 7, 4, 20, 18, 16, 7, 9, 50, 19, 2, 8, 25, 25, 2, 10, 7, 8, 3, 15, 50, 10, 3, 20, 11, 24, 20, 1, 8, 50, 2, 10, 50, 9, 2, 50, 15, 6, 9, 1, 50, 14, 3, 6, 21, 22, 21, 5, 24, 1, 16, 11, 23, 5, 16, 3, 1, 9, 15, 9, 3, 6, 15, 3, 7, 5, 14, 18, 19, 50, 22, 19, 13, 24, 17, 2, 50, 50, 7, 20, 14, 6, 7, 9, 12, 12, 2, 3, 16, 4, 16, 24, 23, 7, 6, 8, 10]
len_epoch: 100
 
Avg validation Stats after 20 global rounds:
Validation Loss : 0.1423939043845603
Validation Accuracy: 95.78% 

Validation loss decreased (0.144527 --> 0.142394).  Saving model ...

 | Global Training Round : 21 |

len idxs_epoch 10
idxs_epoch [20, 3, 15, 15, 10, 8, 6, 9, 5, 10, 15, 10, 23, 23, 10, 10, 19, 11, 14, 19, 12, 8, 15, 6, 20, 8, 13, 15, 9, 2, 7, 11, 1, 6, 13, 13, 12, 7, 12, 7, 21, 9, 25, 6, 3, 21, 3, 12, 17, 9, 50, 22, 4, 1, 50, 24, 23, 17, 3, 3, 5, 14, 7, 20, 7, 3, 8, 50, 13, 50, 8, 10, 9, 25, 3, 50, 13, 17, 20, 50, 17, 10, 23, 23, 50, 50, 5, 11, 9, 7, 22, 8, 50, 22, 14, 7, 10, 50, 16, 10]
len_epoch: 100
 
Avg validation Stats after 21 global rounds:
Validation Loss : 0.138696964466988
Validation Accuracy: 95.90% 

Validation loss decreased (0.142394 --> 0.138697).  Saving model ...

 | Global Training Round : 22 |

len idxs_epoch 10
idxs_epoch [13, 7, 19, 13, 22, 18, 19, 9, 16, 13, 14, 16, 5, 18, 50, 15, 50, 7, 3, 23, 21, 9, 5, 13, 16, 23, 12, 8, 9, 12, 50, 7, 16, 22, 19, 17, 4, 50, 13, 11, 14, 50, 21, 19, 10, 20, 14, 1, 24, 18, 20, 16, 3, 4, 25, 50, 6, 23, 13, 14, 19, 13, 24, 8, 22, 8, 14, 13, 9, 23, 23, 16, 19, 16, 50, 14, 20, 22, 24, 50, 13, 10, 6, 18, 23, 8, 21, 24, 14, 17, 7, 6, 2, 50, 19, 20, 11, 50, 16, 5]
len_epoch: 100
 
Avg validation Stats after 22 global rounds:
Validation Loss : 0.13768692274283964
Validation Accuracy: 95.93% 

Validation loss decreased (0.138697 --> 0.137687).  Saving model ...

 | Global Training Round : 23 |

len idxs_epoch 10
idxs_epoch [50, 10, 21, 24, 13, 14, 25, 23, 19, 9, 16, 22, 12, 20, 4, 22, 17, 6, 4, 24, 7, 24, 25, 5, 16, 2, 1, 14, 50, 5, 8, 19, 12, 24, 14, 10, 4, 13, 4, 17, 50, 12, 16, 11, 24, 16, 50, 18, 18, 24, 22, 8, 21, 20, 22, 24, 5, 1, 9, 21, 20, 25, 50, 13, 50, 16, 19, 4, 24, 25, 24, 11, 19, 3, 7, 11, 3, 8, 6, 22, 50, 22, 1, 21, 17, 18, 17, 2, 23, 7, 50, 25, 25, 50, 3, 24, 24, 50, 9, 11]
len_epoch: 100
 
Avg validation Stats after 23 global rounds:
Validation Loss : 0.13312043358889059
Validation Accuracy: 95.98% 

Validation loss decreased (0.137687 --> 0.133120).  Saving model ...

 | Global Training Round : 24 |

len idxs_epoch 10
idxs_epoch [3, 23, 50, 17, 7, 20, 23, 13, 20, 14, 12, 23, 19, 14, 11, 5, 16, 17, 7, 50, 23, 18, 16, 1, 9, 50, 25, 9, 7, 5, 3, 18, 2, 15, 6, 13, 4, 16, 9, 50, 17, 23, 12, 4, 4, 25, 25, 23, 50, 15, 50, 2, 50, 5, 50, 24, 10, 1, 7, 1, 19, 3, 50, 50, 3, 24, 11, 14, 18, 7, 4, 22, 1, 25, 4, 8, 9, 16, 2, 11, 16, 7, 1, 18, 11, 15, 8, 7, 21, 25, 7, 7, 7, 1, 5, 20, 13, 12, 11, 3]
len_epoch: 100
 
Avg validation Stats after 24 global rounds:
Validation Loss : 0.1308418187900315
Validation Accuracy: 96.13% 

Validation loss decreased (0.133120 --> 0.130842).  Saving model ...

 | Global Training Round : 25 |

len idxs_epoch 10
idxs_epoch [50, 3, 15, 50, 22, 22, 5, 19, 17, 12, 20, 12, 18, 19, 22, 8, 22, 22, 24, 5, 18, 15, 22, 8, 24, 25, 24, 22, 13, 14, 22, 4, 3, 11, 7, 7, 4, 4, 4, 14, 18, 17, 17, 25, 25, 23, 50, 20, 50, 10, 14, 4, 2, 50, 2, 4, 19, 11, 1, 13, 7, 19, 21, 11, 13, 21, 17, 8, 12, 50, 50, 13, 21, 1, 15, 23, 1, 17, 21, 50, 1, 1, 50, 8, 5, 1, 2, 14, 50, 11, 4, 13, 17, 20, 24, 22, 1, 6, 9, 5]
len_epoch: 100
 
Avg validation Stats after 25 global rounds:
Validation Loss : 0.1272311699726124
Validation Accuracy: 96.20% 

Validation loss decreased (0.130842 --> 0.127231).  Saving model ...

 | Global Training Round : 26 |

len idxs_epoch 10
idxs_epoch [11, 17, 4, 5, 50, 13, 18, 17, 5, 18, 50, 50, 17, 4, 5, 20, 6, 19, 21, 7, 6, 6, 13, 13, 5, 50, 6, 21, 17, 19, 23, 50, 20, 20, 22, 21, 12, 12, 20, 6, 15, 16, 15, 10, 23, 6, 50, 23, 16, 14, 1, 14, 6, 11, 12, 20, 21, 15, 19, 16, 15, 13, 11, 50, 7, 23, 50, 1, 11, 4, 20, 8, 20, 18, 24, 20, 22, 10, 20, 23, 21, 8, 50, 12, 19, 13, 2, 50, 7, 3, 16, 18, 4, 4, 12, 4, 15, 20, 8, 10]
len_epoch: 100
 
Avg validation Stats after 26 global rounds:
Validation Loss : 0.12406988316743071
Validation Accuracy: 96.32% 

Validation loss decreased (0.127231 --> 0.124070).  Saving model ...

 | Global Training Round : 27 |

len idxs_epoch 10
idxs_epoch [20, 7, 5, 50, 6, 6, 50, 10, 18, 9, 24, 16, 5, 23, 50, 6, 19, 18, 11, 8, 6, 50, 25, 12, 9, 5, 13, 8, 9, 22, 6, 8, 22, 13, 24, 4, 16, 11, 17, 23, 11, 18, 50, 14, 17, 14, 4, 24, 13, 17, 16, 24, 11, 14, 16, 6, 50, 6, 22, 50, 4, 6, 50, 16, 50, 5, 4, 9, 19, 8, 3, 25, 18, 10, 16, 22, 5, 16, 24, 5, 20, 14, 3, 10, 15, 12, 14, 7, 22, 21, 23, 12, 9, 5, 18, 13, 50, 1, 23, 3]
len_epoch: 100
 
Avg validation Stats after 27 global rounds:
Validation Loss : 0.12199510151993309
Validation Accuracy: 96.40% 

Validation loss decreased (0.124070 --> 0.121995).  Saving model ...

 | Global Training Round : 28 |

len idxs_epoch 10
idxs_epoch [4, 1, 50, 24, 16, 5, 17, 17, 2, 14, 8, 20, 6, 17, 50, 23, 50, 25, 16, 14, 16, 9, 13, 14, 50, 12, 10, 50, 19, 6, 20, 1, 21, 8, 14, 15, 21, 11, 19, 22, 10, 15, 5, 17, 2, 12, 7, 2, 18, 50, 3, 12, 16, 18, 16, 8, 24, 25, 24, 4, 21, 13, 4, 12, 18, 25, 15, 1, 10, 12, 23, 9, 3, 13, 15, 9, 18, 2, 7, 15, 7, 50, 4, 17, 11, 50, 50, 2, 21, 12, 18, 17, 4, 50, 7, 16, 17, 15, 6, 22]
len_epoch: 100
 
Avg validation Stats after 28 global rounds:
Validation Loss : 0.11962390715368747
Validation Accuracy: 96.42% 

Validation loss decreased (0.121995 --> 0.119624).  Saving model ...

 | Global Training Round : 29 |

len idxs_epoch 10
idxs_epoch [13, 5, 16, 4, 18, 24, 22, 18, 50, 50, 9, 3, 10, 9, 4, 23, 24, 17, 20, 5, 19, 15, 10, 17, 13, 17, 2, 20, 22, 12, 21, 23, 16, 50, 7, 7, 10, 21, 10, 13, 5, 24, 14, 10, 12, 11, 20, 23, 16, 50, 5, 23, 1, 5, 50, 3, 25, 2, 10, 2, 50, 22, 18, 5, 10, 7, 7, 14, 19, 50, 4, 20, 4, 13, 17, 50, 50, 7, 9, 4, 24, 25, 1, 1, 8, 4, 19, 14, 9, 14, 12, 11, 18, 5, 13, 6, 50, 21, 5, 8]
len_epoch: 100
 
Avg validation Stats after 29 global rounds:
Validation Loss : 0.11842229379304993
Validation Accuracy: 96.48% 

Validation loss decreased (0.119624 --> 0.118422).  Saving model ...

 | Global Training Round : 30 |

len idxs_epoch 10
idxs_epoch [5, 20, 50, 22, 2, 23, 16, 7, 17, 7, 9, 11, 4, 50, 2, 17, 25, 7, 25, 8, 50, 13, 2, 9, 12, 13, 17, 12, 25, 14, 21, 50, 4, 19, 8, 4, 7, 11, 20, 22, 7, 2, 50, 12, 23, 11, 22, 5, 3, 2, 21, 2, 24, 7, 11, 13, 5, 5, 10, 14, 20, 5, 4, 50, 14, 50, 6, 19, 11, 16, 24, 12, 25, 50, 14, 25, 21, 14, 9, 10, 50, 7, 24, 50, 6, 18, 2, 11, 15, 7, 15, 16, 7, 7, 20, 15, 12, 24, 19, 1]
len_epoch: 100
 
Avg validation Stats after 30 global rounds:
Validation Loss : 0.1175244966418286
Validation Accuracy: 96.53% 

Validation loss decreased (0.118422 --> 0.117524).  Saving model ...
precision: 0.9674644763167585
recall 0.9675131045786
accuracy 0.9676
F1 score 0.9674426395702135
correct : 9676.0
total : 10000.0
test loss now: 0.09982385230029615
bnatch index: 79
 
 Results after 30 global rounds of training:
 Train loss:  [2.1824082168822656, 1.695246508814009, 1.0546818120340196, 0.8137642759978218, 0.6764930929679144, 0.5926689230762459, 0.5435182617952123, 0.5065645338894451, 0.46713111415252057, 0.4361267605443816, 0.41133926152776124, 0.3944601211645079, 0.3860344887239337, 0.3726314410686966, 0.3405249658126026, 0.33867578390112063, 0.32462619361187595, 0.3194532066458103, 0.3222934952508224, 0.300678658005722, 0.28566363321418264, 0.2731223706495543, 0.2729831652610995, 0.2685487781476216, 0.2630722630586733, 0.26183313463079877, 0.2602639281109029, 0.2561848876603168, 0.2426819570704604, 0.2473626675429487]
 Validation loss:  [2.039523463606835, 0.9956280555129052, 0.5119131971001625, 0.4007868172973395, 0.32617488318495447, 0.28784559295512735, 0.25947773011820396, 0.23972178337280642, 0.22245807118364605, 0.20892685684131002, 0.19727971994632398, 0.18892805855046016, 0.1817462991158245, 0.17406603891006678, 0.16727305452185098, 0.16105171209285618, 0.15469708941984572, 0.14821947951869516, 0.14452681796587424, 0.1423939043845603, 0.138696964466988, 0.13768692274283964, 0.13312043358889059, 0.1308418187900315, 0.1272311699726124, 0.12406988316743071, 0.12199510151993309, 0.11962390715368747, 0.11842229379304993, 0.1175244966418286]
 Validation accuracy:  [61.71666666666666, 84.04999999999993, 88.25000000000004, 89.86666666666672, 91.43333333333334, 92.03333333333337, 92.61666666666672, 93.13333333333338, 93.61666666666677, 93.9000000000001, 94.08333333333344, 94.35000000000011, 94.73333333333343, 94.73333333333343, 95.05000000000011, 95.21666666666678, 95.33333333333343, 95.53333333333345, 95.68333333333344, 95.78333333333345, 95.9000000000001, 95.93333333333344, 95.98333333333343, 96.13333333333343, 96.2000000000001, 96.31666666666676, 96.40000000000009, 96.41666666666676, 96.48333333333343, 96.53333333333342]
 Test Accuracy: 96.76%
 Test loss: 0.10

 Total Run Time: 2509.2550
----------Experiment---------
Namespace(dataset='mnist', epoch=30, frac=0.3, gpu=None, iid=0, kernel_num=9, kernel_sizes='3,4,5', l_batch=128, l_epoch=50, lr=0.01, max_pool='True', method='fedavg', model='cnn', n_classes=10, n_equal=0, norm='batch_norm', num_channels=1, num_filters=32, num_users=100, optimizer='sgd', seed=0, stop=3, straggler_frac=0.7, user_type=0, verbose=1)
 Model : cnn

 Optimizer : sgd
 learning rate : 0.01
 Global Rounds : 30
 Federated settings
Dataset : IID
Fraction of participating users: 0.3
Local batch size: 128
Local epochs: 50
straggler_frac: 0.7

 | Global Training Round : 1 |

len idxs_epoch 31
idxs_epoch [13, 24, 50, 20, 9, 17, 50, 10, 17, 20, 50, 2, 24, 7, 4, 50, 7, 15, 50, 19, 50, 5, 21, 24, 17, 6, 24, 50, 2, 14, 16, 25, 50, 20, 50, 8, 1, 50, 13, 7, 50, 14, 50, 9, 1, 50, 50, 4, 13, 50, 50, 50, 50, 4, 1, 8, 50, 1, 17, 22, 13, 25, 2, 50, 24, 13, 16, 50, 50, 17, 50, 13, 50, 9, 24, 22, 16, 21, 50, 19, 3, 7, 1, 8, 9, 1, 50, 50, 5, 11, 9, 6, 50, 50, 23, 50, 11, 25, 50, 16]
len_epoch: 100
 
Avg validation Stats after 1 global rounds:
Validation Loss : 2.102955617070198
Validation Accuracy: 55.42% 

Validation loss decreased (inf --> 2.102956).  Saving model ...

 | Global Training Round : 2 |

len idxs_epoch 31
idxs_epoch [50, 18, 4, 6, 17, 4, 12, 50, 50, 14, 50, 50, 16, 50, 5, 50, 6, 9, 24, 4, 20, 18, 50, 10, 8, 18, 50, 5, 25, 24, 23, 50, 1, 50, 19, 24, 50, 17, 50, 50, 50, 50, 5, 15, 11, 11, 24, 50, 50, 15, 1, 21, 15, 50, 15, 14, 22, 19, 15, 18, 10, 12, 18, 2, 4, 50, 8, 6, 14, 15, 13, 10, 50, 22, 18, 2, 1, 11, 50, 50, 50, 12, 50, 50, 11, 24, 2, 16, 2, 6, 50, 6, 25, 10, 7, 3, 50, 17, 50, 50]
len_epoch: 100
 
Avg validation Stats after 2 global rounds:
Validation Loss : 1.1026311215162277
Validation Accuracy: 79.10% 

Validation loss decreased (2.102956 --> 1.102631).  Saving model ...

 | Global Training Round : 3 |

len idxs_epoch 31
idxs_epoch [24, 50, 8, 50, 50, 11, 18, 7, 10, 50, 4, 15, 4, 23, 50, 17, 2, 14, 23, 50, 50, 20, 5, 19, 50, 50, 16, 11, 18, 9, 50, 50, 15, 16, 25, 50, 19, 50, 50, 2, 21, 3, 50, 5, 50, 50, 50, 50, 15, 15, 50, 13, 12, 50, 20, 18, 17, 50, 18, 14, 22, 4, 14, 15, 22, 19, 21, 2, 9, 14, 6, 2, 50, 50, 7, 25, 50, 17, 15, 16, 50, 12, 13, 25, 50, 50, 4, 8, 25, 23, 24, 50, 19, 22, 20, 21, 50, 10, 50, 3]
len_epoch: 100
 
Avg validation Stats after 3 global rounds:
Validation Loss : 0.5544953916855158
Validation Accuracy: 85.18% 

Validation loss decreased (1.102631 --> 0.554495).  Saving model ...

 | Global Training Round : 4 |

len idxs_epoch 31
idxs_epoch [14, 50, 50, 50, 22, 50, 14, 15, 10, 18, 22, 24, 19, 15, 50, 17, 50, 12, 15, 18, 16, 8, 3, 16, 8, 25, 12, 11, 13, 2, 50, 50, 3, 13, 50, 3, 50, 50, 50, 4, 50, 13, 50, 2, 19, 21, 10, 18, 11, 4, 23, 50, 50, 19, 50, 17, 18, 50, 17, 24, 10, 50, 9, 20, 6, 15, 18, 9, 15, 50, 50, 1, 9, 1, 50, 9, 8, 2, 50, 12, 50, 50, 11, 23, 50, 25, 5, 15, 50, 50, 7, 12, 50, 50, 23, 50, 10, 11, 11, 23]
len_epoch: 100
 
Avg validation Stats after 4 global rounds:
Validation Loss : 0.4394706737119705
Validation Accuracy: 88.45% 

Validation loss decreased (0.554495 --> 0.439471).  Saving model ...

 | Global Training Round : 5 |

len idxs_epoch 31
idxs_epoch [50, 50, 11, 12, 6, 50, 19, 11, 50, 9, 50, 25, 12, 8, 50, 9, 16, 18, 50, 9, 17, 16, 16, 50, 50, 16, 23, 16, 2, 10, 50, 24, 50, 24, 50, 13, 50, 13, 10, 8, 50, 21, 50, 7, 3, 1, 13, 50, 11, 50, 50, 1, 50, 17, 6, 4, 1, 24, 50, 15, 20, 18, 3, 50, 8, 8, 16, 13, 11, 14, 25, 22, 3, 50, 24, 5, 22, 12, 12, 1, 14, 14, 50, 12, 2, 50, 19, 50, 4, 50, 50, 10, 50, 10, 50, 16, 25, 5, 13, 50]
len_epoch: 100
 
Avg validation Stats after 5 global rounds:
Validation Loss : 0.3502026933636517
Validation Accuracy: 90.27% 

Validation loss decreased (0.439471 --> 0.350203).  Saving model ...

 | Global Training Round : 6 |

len idxs_epoch 31
idxs_epoch [18, 50, 50, 14, 23, 22, 7, 50, 50, 11, 24, 12, 4, 50, 8, 9, 17, 50, 50, 50, 7, 23, 16, 50, 2, 7, 5, 7, 24, 50, 50, 50, 50, 13, 9, 20, 50, 17, 50, 9, 3, 50, 50, 15, 3, 1, 20, 8, 25, 7, 50, 50, 8, 21, 50, 50, 5, 7, 4, 23, 24, 4, 19, 19, 19, 22, 22, 14, 5, 3, 50, 16, 50, 23, 5, 4, 3, 4, 17, 7, 8, 50, 10, 13, 6, 14, 50, 22, 2, 24, 50, 50, 50, 50, 14, 20, 10, 8, 50, 50]
len_epoch: 100
 
Avg validation Stats after 6 global rounds:
Validation Loss : 0.31000641360133874
Validation Accuracy: 91.17% 

Validation loss decreased (0.350203 --> 0.310006).  Saving model ...

 | Global Training Round : 7 |

len idxs_epoch 31
idxs_epoch [23, 50, 50, 24, 5, 50, 11, 12, 13, 50, 7, 50, 16, 12, 20, 50, 19, 50, 7, 25, 50, 20, 4, 4, 2, 17, 50, 18, 20, 11, 50, 50, 24, 8, 13, 50, 20, 24, 5, 50, 50, 6, 20, 24, 8, 6, 23, 50, 10, 10, 50, 8, 1, 13, 23, 50, 20, 50, 50, 50, 50, 50, 50, 9, 23, 13, 1, 5, 19, 50, 7, 22, 50, 50, 15, 6, 14, 11, 50, 21, 11, 18, 7, 8, 20, 6, 6, 19, 22, 50, 19, 5, 23, 50, 50, 25, 18, 24, 50, 8]
len_epoch: 100
 
Avg validation Stats after 7 global rounds:
Validation Loss : 0.28233453379245466
Validation Accuracy: 91.92% 

Validation loss decreased (0.310006 --> 0.282335).  Saving model ...

 | Global Training Round : 8 |

len idxs_epoch 31
idxs_epoch [8, 50, 19, 13, 19, 18, 7, 21, 50, 7, 12, 11, 50, 50, 18, 50, 50, 1, 22, 21, 10, 21, 50, 24, 8, 15, 6, 50, 1, 16, 3, 50, 3, 12, 14, 5, 50, 50, 23, 1, 11, 50, 8, 50, 24, 50, 21, 23, 23, 13, 23, 50, 50, 20, 12, 9, 50, 50, 50, 17, 25, 50, 10, 50, 2, 7, 50, 50, 50, 2, 5, 10, 12, 23, 1, 25, 50, 50, 50, 2, 20, 50, 22, 18, 50, 50, 5, 24, 15, 23, 18, 21, 19, 23, 13, 1, 50, 17, 23, 15]
len_epoch: 100
 
Avg validation Stats after 8 global rounds:
Validation Loss : 0.2605033242334612
Validation Accuracy: 92.53% 

Validation loss decreased (0.282335 --> 0.260503).  Saving model ...

 | Global Training Round : 9 |

len idxs_epoch 31
idxs_epoch [50, 50, 11, 11, 50, 50, 21, 21, 6, 50, 6, 4, 12, 2, 11, 50, 50, 5, 50, 12, 50, 13, 50, 5, 12, 50, 12, 50, 6, 50, 4, 17, 13, 20, 4, 13, 50, 50, 23, 14, 17, 50, 11, 1, 50, 10, 50, 12, 16, 11, 50, 50, 15, 8, 8, 14, 3, 50, 50, 4, 7, 5, 50, 21, 11, 2, 10, 25, 19, 6, 3, 12, 16, 17, 3, 19, 13, 50, 50, 11, 18, 15, 20, 50, 15, 50, 22, 50, 19, 17, 50, 50, 18, 25, 24, 50, 24, 12, 5, 14]
len_epoch: 100
 
Avg validation Stats after 9 global rounds:
Validation Loss : 0.24030967776593748
Validation Accuracy: 92.77% 

Validation loss decreased (0.260503 --> 0.240310).  Saving model ...

 | Global Training Round : 10 |

len idxs_epoch 31
idxs_epoch [11, 1, 7, 12, 50, 10, 20, 4, 20, 50, 50, 8, 10, 50, 18, 9, 50, 18, 19, 1, 50, 21, 19, 17, 18, 10, 11, 50, 15, 8, 50, 50, 18, 5, 8, 11, 4, 50, 22, 2, 50, 24, 50, 14, 50, 50, 50, 50, 6, 50, 19, 17, 1, 15, 50, 14, 1, 1, 19, 17, 16, 50, 15, 8, 8, 25, 10, 50, 9, 23, 4, 12, 50, 50, 3, 24, 50, 21, 17, 15, 3, 16, 2, 6, 4, 50, 20, 50, 50, 50, 3, 3, 50, 10, 21, 50, 14, 50, 21, 19]
len_epoch: 100
 
Avg validation Stats after 10 global rounds:
Validation Loss : 0.22424122228100896
Validation Accuracy: 93.27% 

Validation loss decreased (0.240310 --> 0.224241).  Saving model ...

 | Global Training Round : 11 |

len idxs_epoch 31
idxs_epoch [6, 8, 50, 15, 25, 25, 19, 50, 50, 50, 22, 9, 50, 20, 50, 50, 25, 13, 9, 50, 50, 21, 11, 50, 21, 50, 10, 18, 21, 11, 50, 23, 50, 50, 7, 2, 16, 50, 12, 25, 50, 19, 23, 10, 20, 17, 50, 50, 12, 16, 14, 24, 7, 50, 9, 9, 21, 13, 50, 14, 9, 50, 18, 8, 1, 10, 50, 16, 16, 50, 25, 22, 9, 50, 50, 17, 22, 8, 13, 50, 6, 50, 21, 23, 15, 2, 50, 2, 50, 11, 50, 50, 11, 17, 11, 23, 6, 8, 19, 19]
len_epoch: 100
 
Avg validation Stats after 11 global rounds:
Validation Loss : 0.21159762678830885
Validation Accuracy: 93.70% 

Validation loss decreased (0.224241 --> 0.211598).  Saving model ...

 | Global Training Round : 12 |

len idxs_epoch 31
idxs_epoch [2, 8, 12, 50, 21, 23, 50, 3, 50, 11, 5, 50, 15, 20, 50, 22, 5, 50, 11, 16, 6, 7, 6, 50, 50, 5, 10, 8, 50, 6, 5, 50, 22, 6, 50, 50, 22, 50, 24, 50, 23, 11, 10, 11, 12, 1, 50, 10, 14, 5, 23, 19, 50, 50, 6, 50, 11, 50, 8, 3, 10, 7, 1, 7, 9, 17, 17, 19, 3, 50, 18, 5, 50, 7, 50, 7, 50, 21, 19, 50, 3, 6, 50, 50, 10, 18, 20, 50, 50, 24, 50, 22, 23, 1, 21, 50, 25, 10, 25, 25]
len_epoch: 100
 
Avg validation Stats after 12 global rounds:
Validation Loss : 0.19809438645956112
Validation Accuracy: 93.98% 

Validation loss decreased (0.211598 --> 0.198094).  Saving model ...

 | Global Training Round : 13 |

len idxs_epoch 31
idxs_epoch [21, 5, 25, 50, 5, 50, 11, 2, 50, 19, 2, 6, 50, 9, 19, 6, 11, 14, 25, 50, 22, 22, 50, 50, 50, 24, 2, 2, 14, 3, 50, 18, 50, 12, 10, 50, 50, 8, 17, 23, 16, 8, 19, 22, 18, 50, 10, 14, 13, 50, 14, 7, 16, 22, 22, 50, 50, 50, 21, 24, 21, 5, 12, 50, 1, 16, 50, 16, 16, 50, 4, 16, 13, 50, 25, 10, 14, 5, 4, 50, 4, 25, 50, 11, 50, 19, 6, 9, 1, 50, 4, 20, 50, 50, 15, 50, 50, 50, 50, 7]
len_epoch: 100
 
Avg validation Stats after 13 global rounds:
Validation Loss : 0.1875381721071317
Validation Accuracy: 94.37% 

Validation loss decreased (0.198094 --> 0.187538).  Saving model ...

 | Global Training Round : 14 |

len idxs_epoch 31
idxs_epoch [25, 18, 50, 9, 50, 50, 50, 50, 6, 16, 18, 50, 4, 1, 50, 8, 50, 19, 1, 14, 15, 50, 22, 23, 5, 11, 15, 14, 50, 50, 2, 12, 19, 22, 5, 16, 23, 8, 3, 13, 23, 13, 4, 5, 50, 8, 50, 50, 4, 50, 9, 21, 50, 10, 4, 21, 5, 50, 3, 50, 2, 18, 50, 17, 50, 5, 25, 22, 5, 50, 10, 14, 50, 11, 5, 1, 5, 7, 50, 50, 20, 10, 12, 1, 50, 50, 50, 20, 4, 25, 14, 22, 9, 50, 23, 3, 50, 50, 5, 4]
len_epoch: 100
 
Avg validation Stats after 14 global rounds:
Validation Loss : 0.1777720752422465
Validation Accuracy: 94.65% 

Validation loss decreased (0.187538 --> 0.177772).  Saving model ...

 | Global Training Round : 15 |

len idxs_epoch 31
idxs_epoch [50, 19, 17, 50, 2, 50, 50, 4, 18, 21, 50, 50, 15, 24, 2, 15, 21, 15, 50, 15, 50, 10, 50, 6, 50, 50, 50, 21, 16, 14, 1, 20, 7, 50, 6, 5, 50, 6, 16, 50, 9, 50, 2, 50, 50, 50, 4, 20, 18, 50, 24, 23, 25, 7, 22, 50, 50, 6, 50, 50, 10, 2, 15, 20, 19, 50, 1, 2, 4, 50, 17, 7, 7, 11, 24, 50, 50, 50, 50, 21, 7, 10, 12, 8, 17, 21, 22, 23, 13, 7, 6, 22, 50, 8, 11, 1, 21, 9, 18, 2]
len_epoch: 100
 
Avg validation Stats after 15 global rounds:
Validation Loss : 0.17166067680687408
Validation Accuracy: 94.97% 

Validation loss decreased (0.177772 --> 0.171661).  Saving model ...

 | Global Training Round : 16 |

len idxs_epoch 31
idxs_epoch [12, 23, 50, 14, 50, 7, 50, 11, 6, 50, 15, 21, 11, 10, 50, 50, 19, 50, 16, 50, 50, 50, 19, 19, 50, 11, 50, 8, 16, 50, 50, 13, 22, 50, 20, 50, 19, 50, 20, 24, 22, 9, 50, 6, 9, 20, 50, 19, 8, 4, 50, 50, 16, 17, 1, 10, 12, 19, 1, 6, 50, 22, 5, 14, 5, 2, 13, 7, 50, 50, 50, 25, 50, 11, 11, 3, 19, 20, 16, 50, 15, 10, 24, 21, 18, 16, 20, 10, 50, 11, 11, 11, 21, 13, 50, 9, 21, 50, 50, 8]
len_epoch: 100
 
Avg validation Stats after 16 global rounds:
Validation Loss : 0.16413523740909294
Validation Accuracy: 95.17% 

Validation loss decreased (0.171661 --> 0.164135).  Saving model ...

 | Global Training Round : 17 |

len idxs_epoch 31
idxs_epoch [50, 23, 50, 17, 7, 50, 50, 18, 5, 24, 10, 50, 18, 1, 15, 15, 24, 50, 24, 50, 12, 50, 13, 50, 50, 2, 17, 22, 50, 3, 50, 1, 50, 19, 50, 18, 22, 5, 50, 22, 50, 25, 2, 11, 18, 23, 50, 50, 19, 11, 20, 50, 7, 2, 9, 23, 8, 10, 10, 16, 6, 17, 50, 50, 18, 3, 18, 13, 2, 24, 10, 15, 17, 50, 17, 50, 50, 14, 4, 50, 6, 20, 50, 50, 4, 50, 13, 13, 12, 50, 50, 25, 20, 24, 10, 50, 19, 14, 14, 20]
len_epoch: 100
 
Avg validation Stats after 17 global rounds:
Validation Loss : 0.15774132036382799
Validation Accuracy: 95.40% 

Validation loss decreased (0.164135 --> 0.157741).  Saving model ...

 | Global Training Round : 18 |

len idxs_epoch 31
idxs_epoch [21, 50, 1, 50, 50, 4, 18, 50, 22, 13, 5, 15, 50, 16, 5, 25, 5, 50, 15, 21, 6, 19, 4, 50, 24, 3, 50, 8, 14, 14, 2, 17, 12, 50, 9, 50, 50, 50, 11, 9, 6, 6, 19, 50, 23, 5, 19, 5, 13, 50, 10, 50, 50, 50, 5, 7, 50, 2, 50, 50, 50, 21, 50, 21, 12, 50, 2, 5, 17, 9, 3, 3, 19, 50, 50, 20, 24, 20, 50, 11, 18, 18, 20, 10, 13, 50, 16, 4, 9, 3, 8, 50, 18, 50, 1, 1, 23, 12, 25, 50]
len_epoch: 100
 
Avg validation Stats after 18 global rounds:
Validation Loss : 0.1529618105396512
Validation Accuracy: 95.43% 

Validation loss decreased (0.157741 --> 0.152962).  Saving model ...

 | Global Training Round : 19 |

len idxs_epoch 31
idxs_epoch [50, 50, 13, 50, 50, 50, 50, 50, 18, 5, 19, 4, 2, 11, 10, 11, 50, 19, 6, 11, 15, 50, 50, 3, 14, 50, 20, 50, 2, 25, 23, 19, 50, 8, 13, 50, 50, 15, 50, 25, 10, 17, 10, 18, 8, 11, 23, 3, 50, 4, 16, 24, 10, 25, 16, 9, 18, 17, 16, 50, 21, 50, 50, 50, 3, 16, 50, 50, 23, 25, 25, 5, 50, 50, 7, 7, 50, 50, 50, 20, 50, 50, 50, 15, 3, 8, 12, 1, 13, 1, 18, 5, 6, 17, 10, 10, 21, 2, 11, 11]
len_epoch: 100
 
Avg validation Stats after 19 global rounds:
Validation Loss : 0.14835105950260188
Validation Accuracy: 95.60% 

Validation loss decreased (0.152962 --> 0.148351).  Saving model ...

 | Global Training Round : 20 |

len idxs_epoch 31
idxs_epoch [22, 50, 14, 50, 50, 50, 14, 2, 17, 14, 14, 13, 8, 50, 50, 50, 50, 4, 50, 5, 9, 50, 50, 9, 50, 18, 7, 21, 50, 21, 15, 19, 21, 17, 3, 50, 50, 8, 1, 3, 18, 50, 18, 5, 2, 14, 50, 21, 16, 50, 50, 20, 50, 25, 50, 50, 14, 22, 1, 15, 4, 5, 22, 25, 13, 11, 50, 9, 2, 21, 18, 50, 21, 24, 12, 10, 8, 12, 18, 50, 13, 50, 21, 22, 6, 18, 25, 5, 16, 16, 50, 50, 22, 17, 7, 13, 5, 50, 50, 50]
len_epoch: 100
 
Avg validation Stats after 20 global rounds:
Validation Loss : 0.14542309794895117
Validation Accuracy: 95.67% 

Validation loss decreased (0.148351 --> 0.145423).  Saving model ...

 | Global Training Round : 21 |

len idxs_epoch 31
idxs_epoch [14, 25, 50, 5, 8, 50, 50, 24, 22, 18, 3, 9, 8, 5, 50, 23, 17, 20, 10, 6, 8, 12, 14, 10, 25, 15, 22, 50, 15, 50, 50, 50, 2, 50, 10, 50, 1, 25, 50, 50, 24, 7, 50, 22, 15, 19, 10, 6, 50, 50, 50, 50, 11, 11, 50, 5, 50, 7, 22, 21, 2, 50, 11, 12, 50, 21, 17, 25, 50, 19, 1, 8, 16, 10, 50, 22, 10, 50, 19, 9, 5, 50, 6, 19, 21, 50, 50, 18, 6, 5, 50, 1, 23, 50, 3, 50, 50, 16, 4, 24]
len_epoch: 100
 
Avg validation Stats after 21 global rounds:
Validation Loss : 0.1411466901353124
Validation Accuracy: 95.70% 

Validation loss decreased (0.145423 --> 0.141147).  Saving model ...

 | Global Training Round : 22 |

len idxs_epoch 31
idxs_epoch [7, 50, 50, 14, 24, 21, 50, 19, 50, 50, 50, 11, 5, 1, 50, 16, 19, 13, 20, 21, 13, 50, 1, 20, 10, 50, 50, 14, 4, 6, 50, 3, 4, 1, 24, 50, 18, 21, 50, 11, 25, 21, 50, 25, 50, 50, 6, 17, 24, 16, 14, 50, 50, 17, 4, 7, 50, 11, 21, 7, 4, 16, 1, 21, 10, 6, 50, 50, 17, 50, 19, 7, 50, 50, 50, 18, 3, 50, 50, 7, 7, 23, 50, 15, 50, 15, 5, 24, 2, 18, 5, 1, 16, 14, 10, 3, 15, 25, 50, 50]
len_epoch: 100
 
Avg validation Stats after 22 global rounds:
Validation Loss : 0.13848361478926383
Validation Accuracy: 95.78% 

Validation loss decreased (0.141147 --> 0.138484).  Saving model ...

 | Global Training Round : 23 |

len idxs_epoch 31
idxs_epoch [17, 50, 7, 50, 21, 50, 25, 3, 25, 50, 15, 25, 21, 50, 50, 50, 9, 25, 19, 19, 23, 13, 50, 1, 7, 13, 21, 10, 50, 3, 20, 18, 14, 50, 8, 11, 21, 23, 25, 50, 5, 50, 50, 50, 12, 9, 5, 16, 21, 21, 23, 50, 2, 50, 19, 15, 22, 8, 23, 50, 13, 50, 11, 20, 22, 50, 6, 14, 50, 50, 9, 8, 25, 11, 2, 50, 7, 7, 4, 50, 25, 50, 21, 50, 50, 16, 13, 50, 13, 17, 11, 22, 17, 23, 50, 50, 50, 25, 50, 20]
len_epoch: 100
 
Avg validation Stats after 23 global rounds:
Validation Loss : 0.1356536200322152
Validation Accuracy: 95.93% 

Validation loss decreased (0.138484 --> 0.135654).  Saving model ...

 | Global Training Round : 24 |

len idxs_epoch 31
idxs_epoch [50, 50, 50, 9, 7, 10, 20, 50, 21, 50, 15, 4, 50, 50, 16, 50, 50, 25, 17, 17, 10, 11, 18, 5, 7, 17, 50, 50, 50, 5, 17, 8, 12, 17, 15, 4, 4, 50, 50, 50, 22, 7, 12, 21, 11, 20, 9, 1, 3, 8, 15, 25, 18, 5, 22, 16, 23, 50, 14, 50, 16, 19, 20, 14, 19, 24, 50, 25, 50, 25, 12, 19, 8, 50, 21, 14, 50, 13, 21, 24, 50, 18, 50, 50, 11, 23, 50, 18, 2, 50, 50, 6, 12, 22, 50, 50, 21, 50, 5, 14]
len_epoch: 100
 
Avg validation Stats after 24 global rounds:
Validation Loss : 0.1311522213803691
Validation Accuracy: 96.08% 

Validation loss decreased (0.135654 --> 0.131152).  Saving model ...

 | Global Training Round : 25 |

len idxs_epoch 31
idxs_epoch [1, 17, 6, 23, 12, 50, 11, 50, 23, 50, 25, 50, 50, 16, 50, 50, 50, 7, 12, 21, 24, 23, 50, 50, 50, 7, 5, 17, 23, 50, 1, 50, 25, 50, 50, 7, 19, 22, 50, 50, 22, 12, 50, 25, 15, 5, 21, 17, 3, 7, 18, 50, 18, 5, 22, 5, 13, 21, 16, 16, 19, 12, 50, 20, 7, 50, 50, 22, 16, 3, 50, 23, 16, 7, 4, 18, 19, 1, 25, 12, 6, 50, 50, 13, 15, 5, 3, 50, 10, 12, 50, 18, 15, 50, 50, 24, 50, 2, 50, 21]
len_epoch: 100
 
Avg validation Stats after 25 global rounds:
Validation Loss : 0.12913976580541925
Validation Accuracy: 96.18% 

Validation loss decreased (0.131152 --> 0.129140).  Saving model ...

 | Global Training Round : 26 |

len idxs_epoch 31
idxs_epoch [21, 4, 14, 50, 23, 22, 13, 1, 50, 19, 8, 19, 14, 50, 50, 22, 6, 50, 14, 3, 11, 25, 50, 50, 13, 11, 9, 24, 50, 50, 50, 6, 23, 24, 23, 17, 50, 20, 4, 22, 7, 8, 25, 9, 50, 5, 3, 12, 15, 7, 16, 4, 19, 50, 19, 50, 11, 1, 50, 50, 50, 11, 24, 50, 2, 50, 50, 50, 25, 4, 50, 17, 50, 50, 22, 4, 50, 5, 3, 3, 50, 50, 12, 20, 7, 6, 50, 22, 50, 9, 11, 16, 8, 12, 2, 50, 50, 17, 2, 14]
len_epoch: 100
 
Avg validation Stats after 26 global rounds:
Validation Loss : 0.12759590205571295
Validation Accuracy: 96.20% 

Validation loss decreased (0.129140 --> 0.127596).  Saving model ...

 | Global Training Round : 27 |

len idxs_epoch 31
idxs_epoch [13, 50, 3, 6, 50, 22, 25, 12, 50, 16, 25, 5, 7, 6, 8, 7, 22, 19, 12, 5, 50, 50, 4, 17, 6, 8, 50, 50, 25, 23, 50, 12, 17, 19, 18, 15, 50, 50, 4, 50, 14, 50, 20, 50, 3, 17, 50, 8, 12, 2, 50, 18, 50, 50, 14, 25, 50, 1, 50, 19, 50, 50, 20, 1, 9, 50, 5, 12, 50, 18, 2, 50, 6, 16, 25, 50, 24, 50, 50, 23, 21, 25, 50, 24, 50, 6, 4, 9, 7, 19, 17, 1, 21, 12, 13, 17, 10, 50, 50, 23]
len_epoch: 100
 
Avg validation Stats after 27 global rounds:
Validation Loss : 0.1253927361416354
Validation Accuracy: 96.33% 

Validation loss decreased (0.127596 --> 0.125393).  Saving model ...

 | Global Training Round : 28 |

len idxs_epoch 31
idxs_epoch [5, 6, 13, 4, 50, 20, 15, 13, 6, 4, 6, 50, 50, 12, 15, 3, 23, 10, 50, 19, 50, 50, 22, 50, 24, 25, 50, 50, 1, 50, 5, 20, 17, 18, 5, 16, 12, 2, 50, 19, 22, 13, 50, 50, 19, 16, 9, 50, 50, 50, 6, 4, 14, 20, 19, 11, 50, 50, 1, 50, 10, 15, 6, 50, 9, 1, 50, 50, 10, 13, 2, 15, 10, 50, 4, 5, 19, 22, 50, 50, 23, 5, 50, 50, 50, 9, 12, 50, 5, 14, 3, 50, 2, 2, 50, 5, 6, 7, 10, 25]
len_epoch: 100
 
Avg validation Stats after 28 global rounds:
Validation Loss : 0.12415586870626066
Validation Accuracy: 96.33% 

Validation loss decreased (0.125393 --> 0.124156).  Saving model ...

 | Global Training Round : 29 |

len idxs_epoch 31
idxs_epoch [17, 50, 22, 50, 6, 50, 12, 15, 15, 50, 50, 50, 15, 16, 12, 50, 11, 50, 25, 13, 21, 1, 21, 10, 50, 50, 50, 50, 15, 50, 50, 50, 11, 5, 50, 23, 7, 12, 15, 18, 16, 21, 50, 16, 14, 11, 15, 10, 15, 5, 13, 50, 50, 19, 50, 17, 1, 6, 2, 17, 50, 13, 16, 6, 50, 24, 12, 8, 50, 12, 50, 50, 17, 21, 50, 7, 10, 23, 11, 8, 22, 10, 11, 8, 50, 13, 7, 50, 6, 5, 11, 24, 50, 24, 9, 17, 24, 50, 50, 9]
len_epoch: 100
 
Avg validation Stats after 29 global rounds:
Validation Loss : 0.120839161940894
Validation Accuracy: 96.47% 

Validation loss decreased (0.124156 --> 0.120839).  Saving model ...

 | Global Training Round : 30 |

len idxs_epoch 31
idxs_epoch [11, 13, 20, 16, 18, 13, 50, 13, 3, 15, 17, 50, 15, 11, 50, 12, 2, 12, 50, 50, 23, 50, 25, 19, 50, 50, 25, 10, 14, 15, 50, 8, 11, 2, 5, 3, 21, 10, 50, 50, 50, 50, 17, 6, 50, 50, 25, 17, 24, 50, 50, 4, 18, 2, 50, 22, 24, 21, 23, 50, 3, 14, 25, 20, 15, 3, 11, 11, 2, 50, 50, 50, 23, 50, 8, 50, 18, 12, 50, 3, 23, 15, 50, 50, 6, 8, 8, 25, 50, 11, 19, 13, 2, 50, 24, 50, 7, 50, 22, 22]
len_epoch: 100
 
Avg validation Stats after 30 global rounds:
Validation Loss : 0.11982998193443922
Validation Accuracy: 96.45% 

Validation loss decreased (0.120839 --> 0.119830).  Saving model ...
precision: 0.9646824356343394
recall 0.9648462684806303
accuracy 0.965
F1 score 0.9647132255042704
correct : 9650.0
total : 10000.0
test loss now: 0.10885498375054213
bnatch index: 79
 
 Results after 30 global rounds of training:
 Train loss:  [2.2044695416040634, 1.741311323989635, 1.0689114025635287, 0.8169177250826655, 0.681113302901374, 0.6008548994995916, 0.5341299843456284, 0.5059617805610982, 0.4803519005517333, 0.4444363926610099, 0.41299389090077093, 0.39242901194037455, 0.37965115297957885, 0.3565958433611537, 0.35618567513297683, 0.3234769272365518, 0.3189547686333792, 0.31384599346741987, 0.2923199755306685, 0.2799535094678607, 0.2807940832506996, 0.273251649721333, 0.26297822807874627, 0.2682219742273793, 0.26074617968364266, 0.25237751994428176, 0.258734323886002, 0.24528246422187108, 0.23863240963399104, 0.22614396169111986]
 Validation loss:  [2.102955617070198, 1.1026311215162277, 0.5544953916855158, 0.4394706737119705, 0.3502026933636517, 0.31000641360133874, 0.28233453379245466, 0.2605033242334612, 0.24030967776593748, 0.22424122228100896, 0.21159762678830885, 0.19809438645956112, 0.1875381721071317, 0.1777720752422465, 0.17166067680687408, 0.16413523740909294, 0.15774132036382799, 0.1529618105396512, 0.14835105950260188, 0.14542309794895117, 0.1411466901353124, 0.13848361478926383, 0.1356536200322152, 0.1311522213803691, 0.12913976580541925, 0.12759590205571295, 0.1253927361416354, 0.12415586870626066, 0.120839161940894, 0.11982998193443922]
 Validation accuracy:  [55.41666666666667, 79.09999999999997, 85.18333333333328, 88.45000000000006, 90.2666666666667, 91.16666666666676, 91.91666666666674, 92.53333333333342, 92.76666666666675, 93.26666666666677, 93.7000000000001, 93.9833333333334, 94.36666666666677, 94.6500000000001, 94.96666666666677, 95.16666666666677, 95.4000000000001, 95.43333333333345, 95.60000000000011, 95.66666666666679, 95.70000000000012, 95.78333333333345, 95.93333333333345, 96.08333333333344, 96.18333333333345, 96.2000000000001, 96.33333333333344, 96.33333333333344, 96.46666666666677, 96.4500000000001]
 Test Accuracy: 96.50%
 Test loss: 0.11

 Total Run Time: 3540.6837
----------Experiment---------
Namespace(dataset='mnist', epoch=30, frac=0.3, gpu=None, iid=0, kernel_num=9, kernel_sizes='3,4,5', l_batch=128, l_epoch=50, lr=0.01, max_pool='True', method='fedavg', model='cnn', n_classes=10, n_equal=0, norm='batch_norm', num_channels=1, num_filters=32, num_users=100, optimizer='sgd', seed=0, stop=3, straggler_frac=0.5, user_type=0, verbose=1)
 Model : cnn

 Optimizer : sgd
 learning rate : 0.01
 Global Rounds : 30
 Federated settings
Dataset : IID
Fraction of participating users: 0.3
Local batch size: 128
Local epochs: 50
straggler_frac: 0.5

 | Global Training Round : 1 |

len idxs_epoch 51
idxs_epoch [50, 5, 23, 50, 50, 50, 4, 50, 20, 50, 50, 50, 50, 25, 50, 21, 50, 50, 21, 50, 50, 20, 50, 22, 50, 50, 50, 14, 10, 13, 50, 50, 10, 3, 50, 25, 21, 21, 24, 11, 20, 19, 50, 50, 15, 50, 19, 22, 8, 16, 21, 50, 50, 50, 50, 50, 3, 50, 8, 50, 25, 50, 3, 8, 50, 50, 20, 20, 10, 16, 50, 8, 50, 50, 3, 50, 50, 50, 50, 50, 21, 50, 6, 22, 21, 50, 8, 16, 50, 50, 50, 9, 50, 50, 18, 20, 50, 8, 50, 6]
len_epoch: 100
 
Avg validation Stats after 1 global rounds:
Validation Loss : 1.3580227041840556
Validation Accuracy: 80.10% 

Validation loss decreased (inf --> 1.358023).  Saving model ...

 | Global Training Round : 2 |

len idxs_epoch 51
idxs_epoch [5, 50, 50, 50, 19, 50, 50, 13, 50, 50, 50, 50, 12, 21, 50, 50, 50, 4, 4, 7, 50, 19, 19, 50, 50, 50, 50, 20, 25, 8, 50, 22, 50, 50, 9, 50, 11, 22, 50, 6, 50, 6, 50, 23, 7, 16, 1, 50, 50, 50, 50, 50, 17, 4, 22, 50, 50, 24, 11, 21, 50, 11, 15, 9, 50, 50, 50, 3, 16, 50, 50, 50, 9, 7, 10, 50, 8, 50, 11, 13, 14, 50, 50, 50, 19, 50, 50, 50, 1, 23, 25, 50, 50, 50, 2, 50, 23, 50, 19, 14]
len_epoch: 100
 
Avg validation Stats after 2 global rounds:
Validation Loss : 0.545776101052761
Validation Accuracy: 86.40% 

Validation loss decreased (1.358023 --> 0.545776).  Saving model ...

 | Global Training Round : 3 |

len idxs_epoch 51
idxs_epoch [50, 50, 50, 50, 17, 50, 6, 6, 50, 50, 9, 20, 19, 14, 12, 50, 50, 23, 1, 3, 50, 50, 19, 50, 50, 14, 50, 25, 50, 50, 50, 50, 50, 50, 50, 1, 50, 8, 18, 13, 50, 11, 50, 50, 19, 20, 24, 18, 10, 50, 25, 2, 50, 10, 50, 10, 50, 50, 50, 50, 4, 11, 50, 50, 50, 4, 50, 50, 10, 50, 50, 1, 50, 9, 14, 13, 15, 7, 19, 50, 1, 9, 13, 16, 50, 4, 8, 20, 50, 50, 24, 1, 50, 50, 50, 50, 50, 13, 50, 14]
len_epoch: 100
 
Avg validation Stats after 3 global rounds:
Validation Loss : 0.37899384079407883
Validation Accuracy: 89.80% 

Validation loss decreased (0.545776 --> 0.378994).  Saving model ...

 | Global Training Round : 4 |

len idxs_epoch 51
idxs_epoch [50, 50, 50, 15, 15, 15, 50, 9, 50, 50, 50, 21, 13, 17, 50, 24, 15, 50, 50, 7, 9, 9, 50, 50, 9, 50, 50, 1, 50, 3, 17, 14, 50, 19, 13, 3, 5, 10, 50, 8, 50, 20, 15, 50, 50, 50, 50, 12, 50, 14, 16, 13, 50, 24, 17, 50, 50, 2, 50, 5, 5, 9, 8, 24, 2, 50, 18, 50, 16, 25, 14, 3, 50, 50, 1, 50, 50, 14, 50, 50, 9, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 18]
len_epoch: 100
 
Avg validation Stats after 4 global rounds:
Validation Loss : 0.3027865135101602
Validation Accuracy: 91.38% 

Validation loss decreased (0.378994 --> 0.302787).  Saving model ...

 | Global Training Round : 5 |

len idxs_epoch 51
idxs_epoch [18, 21, 50, 24, 50, 50, 50, 16, 21, 50, 50, 24, 1, 5, 1, 23, 17, 50, 50, 13, 50, 19, 18, 11, 50, 50, 21, 50, 2, 50, 50, 23, 50, 50, 1, 50, 4, 23, 13, 11, 7, 50, 50, 14, 4, 50, 50, 50, 20, 6, 50, 50, 17, 50, 50, 50, 50, 21, 50, 14, 50, 50, 1, 7, 50, 50, 16, 23, 50, 50, 50, 50, 50, 50, 24, 50, 15, 50, 50, 17, 50, 50, 23, 50, 50, 20, 1, 14, 24, 50, 6, 50, 7, 13, 50, 12, 5, 50, 50, 12]
len_epoch: 100
 
Avg validation Stats after 5 global rounds:
Validation Loss : 0.2582610272824531
Validation Accuracy: 92.52% 

Validation loss decreased (0.302787 --> 0.258261).  Saving model ...

 | Global Training Round : 6 |

len idxs_epoch 51
idxs_epoch [50, 50, 50, 50, 8, 18, 1, 13, 50, 4, 22, 24, 50, 50, 50, 50, 50, 50, 50, 12, 1, 17, 50, 50, 50, 50, 19, 50, 16, 50, 50, 9, 11, 23, 50, 13, 5, 9, 50, 22, 5, 22, 50, 4, 14, 50, 50, 14, 21, 20, 50, 50, 22, 50, 18, 24, 20, 20, 50, 50, 7, 17, 50, 6, 50, 50, 50, 8, 50, 50, 50, 50, 8, 50, 10, 22, 50, 11, 22, 50, 50, 50, 17, 50, 50, 16, 19, 3, 13, 50, 50, 50, 50, 21, 11, 50, 13, 50, 50, 15]
len_epoch: 100
 
Avg validation Stats after 6 global rounds:
Validation Loss : 0.2247069688325282
Validation Accuracy: 93.42% 

Validation loss decreased (0.258261 --> 0.224707).  Saving model ...

 | Global Training Round : 7 |

len idxs_epoch 51
idxs_epoch [50, 16, 12, 50, 50, 21, 24, 25, 50, 50, 3, 14, 21, 7, 23, 17, 50, 50, 10, 50, 50, 20, 12, 22, 3, 23, 1, 50, 50, 50, 50, 50, 15, 21, 11, 50, 17, 50, 50, 50, 50, 50, 50, 21, 50, 17, 3, 50, 15, 16, 11, 20, 50, 50, 50, 50, 13, 50, 18, 50, 50, 24, 20, 50, 15, 1, 14, 50, 50, 50, 7, 8, 50, 50, 50, 50, 16, 50, 10, 50, 50, 50, 24, 50, 50, 50, 14, 50, 50, 17, 10, 50, 19, 11, 9, 18, 21, 8, 50, 50]
len_epoch: 100
 
Avg validation Stats after 7 global rounds:
Validation Loss : 0.20399209657014583
Validation Accuracy: 93.95% 

Validation loss decreased (0.224707 --> 0.203992).  Saving model ...

 | Global Training Round : 8 |

len idxs_epoch 51
idxs_epoch [7, 50, 50, 23, 50, 7, 6, 50, 5, 50, 50, 50, 2, 19, 50, 16, 50, 7, 50, 50, 1, 8, 50, 2, 50, 8, 9, 50, 2, 50, 10, 50, 6, 23, 18, 13, 50, 50, 9, 50, 3, 50, 50, 50, 21, 6, 50, 50, 50, 50, 11, 4, 15, 6, 50, 50, 2, 7, 14, 8, 50, 50, 50, 13, 15, 50, 25, 50, 1, 50, 20, 50, 50, 21, 12, 20, 11, 50, 16, 50, 3, 50, 20, 21, 50, 50, 50, 50, 50, 50, 50, 50, 24, 3, 22, 50, 50, 15, 1, 50]
len_epoch: 100
 
Avg validation Stats after 8 global rounds:
Validation Loss : 0.19061164008657216
Validation Accuracy: 94.45% 

Validation loss decreased (0.203992 --> 0.190612).  Saving model ...

 | Global Training Round : 9 |

len idxs_epoch 51
idxs_epoch [50, 50, 23, 23, 50, 21, 16, 50, 50, 8, 50, 17, 50, 4, 50, 12, 23, 50, 25, 18, 8, 50, 23, 17, 50, 6, 23, 50, 1, 22, 23, 50, 50, 50, 50, 3, 50, 50, 25, 50, 1, 50, 50, 50, 7, 9, 4, 50, 18, 2, 50, 25, 18, 50, 50, 21, 15, 50, 50, 2, 50, 25, 5, 50, 9, 15, 50, 6, 50, 50, 50, 20, 9, 50, 18, 50, 50, 50, 50, 20, 50, 7, 50, 1, 50, 11, 50, 50, 50, 5, 50, 23, 50, 50, 11, 50, 5, 13, 22, 50]
len_epoch: 100
 
Avg validation Stats after 9 global rounds:
Validation Loss : 0.17444461966337996
Validation Accuracy: 94.93% 

Validation loss decreased (0.190612 --> 0.174445).  Saving model ...

 | Global Training Round : 10 |

len idxs_epoch 51
idxs_epoch [11, 50, 50, 50, 1, 20, 18, 50, 50, 50, 2, 22, 50, 24, 16, 50, 50, 7, 21, 21, 6, 50, 50, 12, 50, 22, 50, 50, 50, 19, 50, 6, 23, 50, 50, 10, 50, 50, 50, 8, 11, 11, 50, 19, 14, 50, 50, 50, 19, 50, 1, 50, 50, 50, 50, 5, 50, 17, 15, 50, 50, 25, 50, 15, 15, 1, 50, 50, 18, 50, 17, 50, 7, 16, 9, 15, 50, 50, 14, 3, 3, 23, 50, 14, 50, 50, 3, 50, 50, 50, 19, 50, 2, 2, 15, 50, 50, 50, 50, 5]
len_epoch: 100
 
Avg validation Stats after 10 global rounds:
Validation Loss : 0.1647839525472227
Validation Accuracy: 95.22% 

Validation loss decreased (0.174445 --> 0.164784).  Saving model ...

 | Global Training Round : 11 |

len idxs_epoch 51
idxs_epoch [50, 50, 10, 9, 8, 9, 23, 50, 50, 50, 50, 14, 50, 50, 19, 50, 50, 50, 13, 50, 50, 50, 50, 24, 50, 50, 50, 9, 50, 10, 50, 9, 50, 50, 9, 12, 50, 50, 4, 50, 50, 16, 50, 23, 50, 50, 50, 20, 6, 50, 50, 8, 50, 50, 17, 50, 50, 12, 50, 50, 17, 14, 9, 50, 50, 50, 50, 50, 50, 50, 50, 17, 7, 14, 16, 19, 50, 50, 50, 24, 13, 15, 50, 4, 25, 23, 4, 12, 23, 12, 10, 14, 10, 50, 17, 10, 14, 8, 8, 1]
len_epoch: 100
 
Avg validation Stats after 11 global rounds:
Validation Loss : 0.15723297771721267
Validation Accuracy: 95.37% 

Validation loss decreased (0.164784 --> 0.157233).  Saving model ...

 | Global Training Round : 12 |

len idxs_epoch 51
idxs_epoch [50, 50, 50, 25, 50, 50, 14, 50, 50, 50, 1, 50, 15, 2, 50, 50, 19, 24, 14, 25, 7, 50, 50, 13, 50, 18, 50, 2, 7, 6, 8, 9, 3, 3, 15, 50, 50, 12, 50, 10, 9, 50, 50, 2, 11, 7, 50, 12, 1, 12, 50, 50, 50, 50, 50, 50, 50, 50, 13, 16, 24, 4, 50, 5, 50, 50, 50, 1, 7, 50, 50, 50, 50, 50, 50, 17, 50, 5, 50, 50, 50, 20, 7, 25, 50, 6, 2, 16, 50, 6, 8, 6, 50, 50, 7, 50, 50, 50, 50, 19]
len_epoch: 100
 
Avg validation Stats after 12 global rounds:
Validation Loss : 0.1491023533829866
Validation Accuracy: 95.52% 

Validation loss decreased (0.157233 --> 0.149102).  Saving model ...

 | Global Training Round : 13 |

len idxs_epoch 51
idxs_epoch [50, 11, 50, 50, 15, 2, 11, 50, 13, 50, 50, 2, 50, 50, 50, 22, 3, 50, 4, 4, 20, 50, 13, 8, 24, 50, 11, 50, 50, 19, 6, 8, 8, 50, 50, 9, 50, 7, 50, 50, 50, 13, 5, 50, 50, 17, 50, 24, 2, 50, 50, 25, 2, 50, 50, 12, 16, 1, 50, 50, 6, 19, 19, 10, 50, 8, 50, 10, 2, 50, 50, 50, 8, 50, 50, 4, 2, 50, 15, 25, 50, 50, 50, 50, 50, 50, 23, 11, 50, 50, 13, 50, 50, 50, 50, 9, 50, 50, 21, 1]
len_epoch: 100
 
Avg validation Stats after 13 global rounds:
Validation Loss : 0.14277435877884273
Validation Accuracy: 95.78% 

Validation loss decreased (0.149102 --> 0.142774).  Saving model ...

 | Global Training Round : 14 |

len idxs_epoch 51
idxs_epoch [3, 50, 21, 18, 22, 50, 8, 50, 22, 50, 50, 50, 50, 50, 9, 21, 21, 17, 50, 50, 21, 50, 50, 15, 17, 50, 15, 50, 50, 25, 20, 18, 5, 50, 8, 50, 50, 6, 50, 50, 11, 50, 11, 16, 50, 24, 50, 50, 21, 16, 50, 7, 50, 19, 12, 50, 50, 50, 50, 50, 50, 16, 1, 50, 7, 22, 14, 13, 50, 9, 50, 50, 50, 50, 4, 50, 7, 50, 6, 18, 50, 11, 4, 50, 50, 8, 50, 50, 12, 50, 7, 13, 50, 50, 5, 50, 19, 4, 50, 3]
len_epoch: 100
 
Avg validation Stats after 14 global rounds:
Validation Loss : 0.136799703122073
Validation Accuracy: 95.95% 

Validation loss decreased (0.142774 --> 0.136800).  Saving model ...

 | Global Training Round : 15 |

len idxs_epoch 51
idxs_epoch [50, 50, 50, 23, 50, 21, 50, 8, 24, 21, 50, 50, 50, 50, 12, 2, 50, 50, 13, 50, 12, 13, 7, 15, 15, 24, 50, 1, 11, 24, 14, 4, 25, 50, 50, 50, 6, 50, 10, 16, 1, 50, 50, 20, 18, 23, 25, 50, 22, 50, 7, 50, 11, 50, 15, 50, 3, 50, 50, 20, 50, 50, 50, 15, 2, 50, 50, 50, 50, 3, 4, 50, 12, 50, 25, 50, 12, 16, 1, 13, 50, 21, 2, 50, 50, 50, 50, 50, 50, 50, 3, 50, 50, 50, 20, 50, 50, 25, 50, 16]
len_epoch: 100
 
Avg validation Stats after 15 global rounds:
Validation Loss : 0.1328240548309332
Validation Accuracy: 96.10% 

Validation loss decreased (0.136800 --> 0.132824).  Saving model ...

 | Global Training Round : 16 |

len idxs_epoch 51
idxs_epoch [50, 3, 19, 6, 50, 5, 50, 14, 6, 50, 50, 50, 50, 5, 8, 50, 50, 3, 4, 50, 21, 1, 50, 15, 5, 23, 50, 50, 4, 50, 6, 23, 24, 50, 50, 4, 50, 11, 8, 50, 23, 9, 17, 23, 25, 50, 10, 50, 25, 50, 50, 50, 22, 50, 50, 7, 18, 50, 10, 50, 50, 24, 50, 50, 50, 50, 50, 19, 50, 11, 50, 50, 50, 50, 50, 50, 15, 50, 14, 15, 50, 6, 50, 50, 7, 1, 50, 13, 21, 5, 2, 16, 22, 50, 5, 8, 50, 50, 50, 50]
len_epoch: 100
 
Avg validation Stats after 16 global rounds:
Validation Loss : 0.12740645057968508
Validation Accuracy: 96.40% 

Validation loss decreased (0.132824 --> 0.127406).  Saving model ...

 | Global Training Round : 17 |

len idxs_epoch 51
idxs_epoch [17, 23, 50, 50, 50, 50, 50, 6, 8, 50, 6, 50, 3, 13, 50, 50, 18, 50, 2, 8, 50, 50, 21, 50, 4, 50, 2, 6, 3, 23, 50, 50, 23, 50, 17, 13, 50, 15, 7, 50, 18, 2, 12, 50, 11, 14, 50, 8, 50, 50, 21, 50, 17, 9, 13, 6, 19, 20, 50, 15, 4, 50, 50, 50, 50, 3, 50, 50, 50, 14, 50, 50, 7, 16, 50, 50, 50, 50, 16, 50, 50, 50, 8, 50, 12, 16, 22, 23, 50, 22, 50, 50, 50, 50, 12, 5, 50, 50, 1, 50]
len_epoch: 100
 
Avg validation Stats after 17 global rounds:
Validation Loss : 0.1254331623816979
Validation Accuracy: 96.37% 

Validation loss decreased (0.127406 --> 0.125433).  Saving model ...

 | Global Training Round : 18 |

len idxs_epoch 51
idxs_epoch [50, 50, 5, 50, 12, 50, 50, 10, 50, 50, 8, 50, 19, 50, 21, 19, 50, 16, 50, 3, 21, 21, 11, 5, 50, 50, 24, 7, 50, 1, 12, 50, 50, 5, 50, 50, 50, 5, 13, 50, 50, 50, 9, 22, 50, 50, 24, 50, 50, 50, 50, 22, 50, 50, 11, 50, 7, 19, 15, 50, 50, 8, 50, 50, 50, 50, 50, 50, 50, 5, 50, 3, 19, 50, 17, 50, 19, 13, 50, 12, 20, 7, 4, 5, 18, 50, 50, 50, 8, 20, 50, 50, 50, 3, 24, 14, 11, 24, 50, 16]
len_epoch: 100
 
Avg validation Stats after 18 global rounds:
Validation Loss : 0.12277959096047558
Validation Accuracy: 96.57% 

Validation loss decreased (0.125433 --> 0.122780).  Saving model ...

 | Global Training Round : 19 |

len idxs_epoch 51
idxs_epoch [50, 50, 16, 2, 50, 50, 9, 22, 17, 50, 11, 14, 8, 50, 3, 19, 50, 24, 50, 9, 50, 2, 50, 50, 50, 50, 50, 50, 50, 50, 2, 7, 50, 1, 13, 3, 50, 23, 23, 15, 9, 50, 50, 50, 50, 50, 11, 5, 21, 7, 21, 50, 50, 6, 10, 13, 50, 15, 16, 50, 50, 21, 5, 11, 2, 2, 8, 20, 50, 50, 21, 50, 16, 50, 11, 50, 10, 50, 50, 50, 9, 50, 50, 50, 50, 10, 11, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 21, 14]
len_epoch: 100
 
Avg validation Stats after 19 global rounds:
Validation Loss : 0.119011427452333
Validation Accuracy: 96.65% 

Validation loss decreased (0.122780 --> 0.119011).  Saving model ...

 | Global Training Round : 20 |

len idxs_epoch 51
idxs_epoch [6, 50, 4, 25, 50, 50, 50, 23, 50, 50, 50, 50, 21, 50, 2, 50, 2, 5, 2, 50, 4, 50, 21, 10, 50, 12, 50, 50, 50, 11, 50, 50, 50, 50, 4, 2, 50, 50, 24, 50, 50, 11, 50, 50, 23, 50, 50, 14, 50, 50, 50, 23, 20, 50, 50, 7, 50, 1, 21, 50, 50, 18, 1, 20, 50, 50, 3, 4, 22, 3, 18, 17, 3, 16, 3, 50, 50, 25, 22, 50, 4, 50, 22, 50, 50, 50, 14, 22, 25, 10, 15, 50, 50, 2, 50, 2, 50, 5, 50, 17]
len_epoch: 100
 
Avg validation Stats after 20 global rounds:
Validation Loss : 0.1156372119798125
Validation Accuracy: 96.68% 

Validation loss decreased (0.119011 --> 0.115637).  Saving model ...

 | Global Training Round : 21 |

len idxs_epoch 51
idxs_epoch [11, 50, 50, 50, 11, 21, 5, 50, 21, 50, 50, 50, 50, 24, 23, 8, 50, 50, 14, 50, 50, 17, 50, 2, 1, 50, 19, 18, 50, 9, 5, 50, 50, 14, 12, 50, 5, 8, 3, 7, 50, 50, 7, 50, 11, 50, 50, 50, 11, 50, 50, 12, 50, 50, 50, 6, 50, 50, 50, 50, 19, 7, 15, 18, 12, 11, 50, 6, 14, 19, 3, 3, 50, 50, 50, 7, 18, 50, 4, 8, 14, 23, 50, 18, 10, 50, 3, 50, 50, 50, 50, 50, 50, 50, 8, 50, 50, 50, 21, 50]
len_epoch: 100
 
Avg validation Stats after 21 global rounds:
Validation Loss : 0.112321423987034
Validation Accuracy: 96.83% 

Validation loss decreased (0.115637 --> 0.112321).  Saving model ...

 | Global Training Round : 22 |

len idxs_epoch 51
idxs_epoch [6, 25, 50, 14, 5, 50, 50, 24, 11, 50, 50, 50, 19, 20, 3, 50, 50, 50, 50, 50, 22, 8, 50, 9, 6, 50, 50, 23, 50, 50, 50, 50, 6, 7, 12, 50, 12, 50, 23, 50, 50, 7, 5, 5, 20, 50, 50, 8, 50, 50, 24, 5, 10, 50, 5, 23, 50, 50, 50, 50, 50, 50, 50, 19, 11, 8, 50, 10, 50, 18, 20, 50, 13, 50, 50, 50, 8, 7, 15, 50, 50, 50, 10, 50, 50, 50, 50, 23, 25, 17, 9, 16, 10, 22, 16, 50, 50, 50, 24, 11]
len_epoch: 100
 
Avg validation Stats after 22 global rounds:
Validation Loss : 0.11284762647550636
Validation Accuracy: 96.83% 

EarlyStopping counter: 1 out of 3

 | Global Training Round : 23 |

len idxs_epoch 51
idxs_epoch [50, 20, 50, 50, 50, 16, 50, 18, 11, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 3, 13, 9, 10, 22, 12, 10, 25, 50, 50, 19, 22, 13, 50, 19, 25, 14, 50, 22, 15, 50, 6, 15, 50, 10, 50, 23, 50, 2, 8, 2, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 17, 50, 17, 25, 50, 2, 50, 24, 15, 50, 50, 11, 50, 15, 50, 1, 50, 10, 50, 14, 2, 50, 3, 6, 50, 7, 25, 50, 2, 50, 50, 10, 5, 50, 50, 16]
len_epoch: 100
 
Avg validation Stats after 23 global rounds:
Validation Loss : 0.10946291771910724
Validation Accuracy: 96.88% 

Validation loss decreased (0.112321 --> 0.109463).  Saving model ...

 | Global Training Round : 24 |

len idxs_epoch 51
idxs_epoch [17, 50, 50, 50, 50, 50, 50, 19, 15, 23, 21, 50, 6, 15, 50, 19, 7, 16, 3, 22, 5, 2, 50, 22, 50, 17, 7, 16, 50, 16, 50, 17, 16, 50, 50, 50, 50, 50, 50, 50, 7, 50, 13, 50, 19, 50, 13, 8, 10, 50, 20, 50, 22, 22, 50, 50, 50, 19, 6, 50, 23, 50, 50, 50, 50, 9, 23, 1, 2, 14, 50, 50, 4, 5, 50, 50, 50, 50, 24, 21, 50, 50, 23, 50, 19, 17, 5, 10, 50, 50, 15, 25, 50, 50, 50, 50, 50, 50, 50, 50]
len_epoch: 100
 
Avg validation Stats after 24 global rounds:
Validation Loss : 0.11004569487264955
Validation Accuracy: 96.93% 

EarlyStopping counter: 1 out of 3

 | Global Training Round : 25 |

len idxs_epoch 51
idxs_epoch [50, 50, 50, 50, 19, 18, 13, 50, 50, 5, 15, 50, 20, 17, 50, 2, 22, 50, 18, 50, 22, 50, 50, 50, 15, 50, 50, 50, 14, 50, 2, 50, 23, 23, 18, 19, 2, 19, 12, 6, 12, 3, 18, 22, 21, 8, 50, 50, 4, 50, 50, 22, 21, 15, 16, 50, 50, 50, 50, 50, 4, 50, 50, 25, 22, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 9, 50, 25, 50, 50, 50, 50, 50, 1, 50, 10, 50, 18, 3, 50, 15, 50, 22, 9, 21, 6, 50, 50]
len_epoch: 100
 
Avg validation Stats after 25 global rounds:
Validation Loss : 0.10562901584464907
Validation Accuracy: 97.08% 

Validation loss decreased (0.109463 --> 0.105629).  Saving model ...

 | Global Training Round : 26 |

len idxs_epoch 51
idxs_epoch [50, 15, 50, 50, 1, 15, 6, 6, 50, 50, 19, 16, 50, 50, 50, 50, 19, 5, 20, 50, 1, 21, 50, 50, 11, 50, 50, 18, 50, 22, 6, 20, 10, 50, 12, 14, 4, 12, 25, 50, 50, 13, 50, 50, 20, 6, 4, 13, 24, 50, 20, 50, 50, 50, 25, 50, 50, 1, 50, 23, 3, 2, 50, 50, 50, 19, 18, 50, 13, 9, 50, 50, 50, 50, 11, 50, 6, 23, 50, 50, 50, 25, 50, 20, 50, 50, 3, 50, 10, 5, 2, 6, 50, 50, 50, 50, 50, 50, 50, 20]
len_epoch: 100
 
Avg validation Stats after 26 global rounds:
Validation Loss : 0.10322621418999285
Validation Accuracy: 97.10% 

Validation loss decreased (0.105629 --> 0.103226).  Saving model ...

 | Global Training Round : 27 |

len idxs_epoch 51
idxs_epoch [20, 50, 5, 9, 2, 50, 50, 22, 24, 23, 2, 20, 20, 50, 5, 50, 9, 7, 13, 50, 18, 50, 6, 14, 9, 50, 50, 3, 50, 50, 50, 50, 16, 50, 50, 50, 1, 50, 50, 20, 50, 50, 14, 50, 50, 13, 15, 50, 22, 13, 50, 50, 50, 16, 1, 14, 15, 50, 50, 1, 50, 10, 14, 50, 50, 6, 5, 50, 23, 50, 7, 50, 50, 20, 17, 50, 9, 50, 1, 13, 50, 23, 50, 2, 22, 50, 22, 6, 50, 50, 50, 21, 50, 50, 9, 50, 50, 50, 50, 50]
len_epoch: 100
 
Avg validation Stats after 27 global rounds:
Validation Loss : 0.10356655925179666
Validation Accuracy: 97.20% 

EarlyStopping counter: 1 out of 3

 | Global Training Round : 28 |

len idxs_epoch 51
idxs_epoch [50, 50, 12, 11, 18, 15, 5, 50, 50, 14, 50, 23, 50, 5, 50, 22, 2, 24, 14, 15, 50, 17, 1, 50, 15, 14, 20, 50, 10, 50, 50, 50, 2, 50, 50, 50, 11, 50, 50, 25, 50, 22, 10, 50, 22, 2, 12, 50, 16, 20, 6, 50, 50, 8, 50, 50, 15, 6, 50, 8, 17, 50, 50, 50, 3, 50, 50, 3, 50, 50, 50, 17, 10, 12, 23, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 50, 50, 5, 22, 50, 6, 50, 14, 24, 4]
len_epoch: 100
 
Avg validation Stats after 28 global rounds:
Validation Loss : 0.10441413220937472
Validation Accuracy: 97.17% 

EarlyStopping counter: 2 out of 3

 | Global Training Round : 29 |

len idxs_epoch 51
idxs_epoch [50, 50, 50, 15, 50, 24, 14, 16, 18, 5, 50, 1, 18, 15, 50, 50, 50, 50, 50, 50, 25, 50, 50, 24, 2, 15, 50, 50, 3, 4, 50, 50, 14, 50, 3, 50, 21, 23, 5, 50, 5, 50, 19, 50, 50, 24, 16, 50, 25, 6, 23, 50, 50, 50, 50, 7, 50, 5, 50, 50, 8, 50, 15, 50, 50, 50, 50, 4, 16, 15, 21, 50, 50, 21, 22, 8, 50, 19, 16, 9, 50, 11, 13, 50, 50, 50, 3, 50, 50, 50, 18, 50, 50, 50, 11, 18, 50, 50, 23, 12]
len_epoch: 100
 
Avg validation Stats after 29 global rounds:
Validation Loss : 0.10283785131175749
Validation Accuracy: 97.23% 

Validation loss decreased (0.103226 --> 0.102838).  Saving model ...

 | Global Training Round : 30 |

len idxs_epoch 51
idxs_epoch [10, 50, 50, 20, 7, 50, 50, 50, 50, 50, 10, 18, 4, 50, 11, 50, 50, 50, 50, 6, 21, 50, 17, 50, 50, 24, 50, 7, 10, 2, 3, 21, 50, 20, 22, 50, 50, 7, 18, 50, 22, 14, 50, 50, 19, 7, 14, 15, 50, 50, 12, 50, 9, 14, 17, 50, 3, 50, 50, 50, 50, 50, 50, 4, 21, 50, 6, 7, 50, 50, 50, 50, 50, 8, 8, 50, 8, 13, 50, 50, 50, 50, 50, 11, 20, 50, 2, 17, 2, 12, 50, 25, 50, 2, 50, 50, 10, 50, 21, 50]
len_epoch: 100
 
Avg validation Stats after 30 global rounds:
Validation Loss : 0.09946469058192407
Validation Accuracy: 97.25% 

Validation loss decreased (0.102838 --> 0.099465).  Saving model ...
precision: 0.9744735505164772
recall 0.9745585204121732
accuracy 0.9746
F1 score 0.9744796143136991
correct : 9746.0
total : 10000.0
test loss now: 0.08525500728883574
bnatch index: 79
 
 Results after 30 global rounds of training:
 Train loss:  [1.9894444219988812, 1.1225657053044706, 0.7609942607758936, 0.6083931569854657, 0.5223818584150378, 0.4597638521294739, 0.42174370754372215, 0.37828416997748104, 0.35346474213614226, 0.34005131921633297, 0.3089292307515803, 0.2897639681996619, 0.291237865345729, 0.26477396353807936, 0.2510126599065665, 0.25714549224838684, 0.23364993271095855, 0.23397495797906986, 0.23240420629486858, 0.2289030928638532, 0.22226359368575757, 0.207023554702467, 0.199390078311385, 0.19133586242135334, 0.2034672794844902, 0.20925453106893982, 0.18955281743820968, 0.17990233518598792, 0.1741816790767258, 0.1807812955815534]
 Validation loss:  [1.3580227041840556, 0.545776101052761, 0.37899384079407883, 0.3027865135101602, 0.2582610272824531, 0.2247069688325282, 0.20399209657014583, 0.19061164008657216, 0.17444461966337996, 0.1647839525472227, 0.15723297771721267, 0.1491023533829866, 0.14277435877884273, 0.136799703122073, 0.1328240548309332, 0.12740645057968508, 0.1254331623816979, 0.12277959096047558, 0.119011427452333, 0.1156372119798125, 0.112321423987034, 0.11284762647550636, 0.10946291771910724, 0.11004569487264955, 0.10562901584464907, 0.10322621418999285, 0.10356655925179666, 0.10441413220937472, 0.10283785131175749, 0.09946469058192407]
 Validation accuracy:  [80.09999999999995, 86.39999999999998, 89.80000000000001, 91.3833333333334, 92.5166666666668, 93.41666666666679, 93.9500000000001, 94.4500000000001, 94.93333333333342, 95.21666666666675, 95.36666666666676, 95.51666666666675, 95.78333333333343, 95.95000000000009, 96.1000000000001, 96.40000000000008, 96.36666666666675, 96.56666666666673, 96.65000000000006, 96.68333333333341, 96.8333333333334, 96.83333333333341, 96.8833333333334, 96.93333333333341, 97.08333333333341, 97.10000000000007, 97.20000000000007, 97.16666666666674, 97.2333333333334, 97.25000000000006]
 Test Accuracy: 97.46%
 Test loss: 0.09

 Total Run Time: 4691.0864
----------Experiment---------
Namespace(dataset='mnist', epoch=30, frac=0.3, gpu=None, iid=0, kernel_num=9, kernel_sizes='3,4,5', l_batch=128, l_epoch=50, lr=0.01, max_pool='True', method='fedavg', model='cnn', n_classes=10, n_equal=0, norm='batch_norm', num_channels=1, num_filters=32, num_users=100, optimizer='sgd', seed=0, stop=3, straggler_frac=0.3, user_type=0, verbose=1)
 Model : cnn

 Optimizer : sgd
 learning rate : 0.01
 Global Rounds : 30
 Federated settings
Dataset : IID
Fraction of participating users: 0.3
Local batch size: 128
Local epochs: 50
straggler_frac: 0.3

 | Global Training Round : 1 |

len idxs_epoch 71
idxs_epoch [50, 50, 1, 50, 5, 50, 12, 6, 50, 11, 7, 50, 7, 50, 50, 50, 50, 50, 6, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 1, 50, 50, 13, 9, 50, 50, 50, 50, 18, 50, 7, 4, 50, 50, 14, 50, 15, 24, 50, 13, 50, 50, 50, 19, 50, 50, 50, 50, 5, 50, 50, 50, 50, 50, 50, 50, 50, 50, 2, 50, 12, 50, 50, 50, 50, 50, 13, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 7, 16, 50, 5, 50, 50, 8, 3]
len_epoch: 100
 
Avg validation Stats after 1 global rounds:
Validation Loss : 1.0359273691177364
Validation Accuracy: 83.77% 

Validation loss decreased (inf --> 1.035927).  Saving model ...

 | Global Training Round : 2 |

len idxs_epoch 71
idxs_epoch [18, 50, 21, 50, 50, 50, 50, 50, 14, 50, 4, 3, 22, 50, 50, 22, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 5, 23, 50, 50, 50, 8, 50, 50, 2, 50, 50, 50, 50, 50, 50, 50, 50, 12, 7, 6, 50, 16, 6, 50, 13, 50, 50, 50, 50, 50, 50, 1, 50, 50, 2, 50, 50, 15, 50, 50, 9, 50, 19, 50, 50, 5, 50, 50, 19, 11, 50, 50, 20, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 6, 50, 50, 50, 50, 50, 24, 50, 50, 50]
len_epoch: 100
 
Avg validation Stats after 2 global rounds:
Validation Loss : 0.41117312788590765
Validation Accuracy: 89.17% 

Validation loss decreased (1.035927 --> 0.411173).  Saving model ...

 | Global Training Round : 3 |

len idxs_epoch 71
idxs_epoch [4, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 25, 50, 5, 50, 50, 50, 50, 14, 14, 50, 23, 50, 1, 50, 50, 50, 50, 12, 50, 20, 24, 50, 50, 1, 50, 50, 50, 10, 20, 18, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 22, 50, 50, 3, 1, 50, 50, 50, 1, 50, 50, 50, 50, 50, 50, 3, 50, 50, 2, 50, 50, 4, 50, 2, 50, 50, 50, 7, 50, 7, 50, 3, 6, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]
len_epoch: 100
 
Avg validation Stats after 3 global rounds:
Validation Loss : 0.28957753411913284
Validation Accuracy: 91.68% 

Validation loss decreased (0.411173 --> 0.289578).  Saving model ...

 | Global Training Round : 4 |

len idxs_epoch 71
idxs_epoch [50, 50, 13, 5, 11, 50, 50, 6, 2, 50, 23, 50, 50, 18, 50, 50, 50, 50, 21, 50, 12, 50, 50, 50, 50, 23, 50, 16, 50, 21, 50, 50, 12, 50, 50, 8, 50, 50, 2, 50, 50, 50, 24, 50, 25, 50, 50, 50, 50, 2, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 11, 50, 20, 50, 11, 50, 10, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 21, 50, 6, 50, 50, 24, 11, 50, 50, 14, 50, 50]
len_epoch: 100
 
Avg validation Stats after 4 global rounds:
Validation Loss : 0.24627836884697904
Validation Accuracy: 92.73% 

Validation loss decreased (0.289578 --> 0.246278).  Saving model ...

 | Global Training Round : 5 |

len idxs_epoch 71
idxs_epoch [50, 5, 16, 9, 24, 11, 50, 15, 14, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 19, 50, 50, 9, 50, 6, 50, 7, 50, 50, 50, 50, 50, 50, 50, 6, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 20, 50, 50, 9, 50, 50, 50, 50, 50, 50, 22, 11, 50, 4, 50, 2, 50, 50, 25, 50, 50, 50, 8, 50, 50, 14, 2, 5, 50, 17, 17, 50, 50, 50, 50, 8, 50, 50, 50, 11, 50, 50, 22, 50, 50, 50]
len_epoch: 100
 
Avg validation Stats after 5 global rounds:
Validation Loss : 0.21098625293700035
Validation Accuracy: 93.78% 

Validation loss decreased (0.246278 --> 0.210986).  Saving model ...

 | Global Training Round : 6 |

len idxs_epoch 71
idxs_epoch [3, 5, 50, 50, 50, 15, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 21, 8, 50, 50, 50, 50, 14, 50, 3, 50, 50, 12, 24, 50, 24, 50, 2, 50, 50, 50, 10, 18, 13, 10, 50, 50, 5, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 1, 50, 50, 50, 50, 8, 50, 50, 15, 50, 50, 12, 50, 50, 50, 50, 50, 17, 50, 13, 50, 50, 1, 16, 50, 7, 4, 50, 13, 50, 50, 50, 50, 50, 50, 3, 50, 50, 50, 50, 50, 50]
len_epoch: 100
 
Avg validation Stats after 6 global rounds:
Validation Loss : 0.19214852322064682
Validation Accuracy: 94.20% 

Validation loss decreased (0.210986 --> 0.192149).  Saving model ...

 | Global Training Round : 7 |

len idxs_epoch 71
idxs_epoch [50, 50, 50, 50, 50, 21, 18, 15, 50, 50, 50, 18, 50, 50, 18, 50, 1, 2, 5, 18, 50, 50, 7, 50, 10, 50, 50, 50, 4, 50, 50, 50, 50, 50, 12, 50, 18, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 22, 50, 8, 50, 50, 50, 14, 50, 18, 50, 50, 50, 8, 19, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 1, 5, 50, 50, 50, 14, 50, 21, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 6, 50, 9, 50, 50, 50, 50, 50]
len_epoch: 100
 
Avg validation Stats after 7 global rounds:
Validation Loss : 0.17857619722168605
Validation Accuracy: 94.70% 

Validation loss decreased (0.192149 --> 0.178576).  Saving model ...

 | Global Training Round : 8 |

len idxs_epoch 71
idxs_epoch [50, 25, 21, 4, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 15, 50, 50, 2, 50, 50, 50, 50, 15, 50, 50, 50, 25, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 8, 50, 50, 12, 23, 11, 50, 50, 50, 50, 50, 50, 50, 1, 8, 50, 50, 50, 50, 6, 4, 50, 50, 5, 50, 1, 50, 50, 50, 50, 19, 24, 50, 50, 50, 50, 7, 50, 50, 50, 50, 50, 50, 50, 10, 50, 16, 50, 10, 50, 12, 50, 4, 50, 23, 50, 11, 16, 50, 50]
len_epoch: 100
 
Avg validation Stats after 8 global rounds:
Validation Loss : 0.1687859660927061
Validation Accuracy: 95.00% 

Validation loss decreased (0.178576 --> 0.168786).  Saving model ...

 | Global Training Round : 9 |

len idxs_epoch 71
idxs_epoch [50, 50, 4, 50, 50, 50, 5, 6, 50, 50, 50, 50, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 23, 50, 50, 50, 50, 14, 50, 50, 50, 50, 8, 50, 25, 50, 16, 50, 25, 50, 4, 50, 50, 25, 50, 23, 50, 50, 50, 7, 50, 50, 50, 50, 5, 50, 50, 50, 7, 50, 50, 50, 3, 14, 7, 19, 50, 50, 50, 3, 3, 50, 50, 50, 25, 5, 2, 50, 50, 50, 10, 50, 3, 50, 50, 50, 50, 50, 50, 50, 50, 5, 9]
len_epoch: 100
 
Avg validation Stats after 9 global rounds:
Validation Loss : 0.1571225002568462
Validation Accuracy: 95.25% 

Validation loss decreased (0.168786 --> 0.157123).  Saving model ...

 | Global Training Round : 10 |

len idxs_epoch 71
idxs_epoch [50, 50, 15, 50, 4, 50, 50, 12, 4, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 9, 50, 50, 17, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 3, 22, 19, 9, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 6, 50, 50, 50, 50, 50, 24, 10, 50, 50, 9, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 14, 50, 50, 13, 20, 50, 3, 22, 8, 50, 50, 50, 11, 50, 23, 50, 50, 50, 50, 50, 8, 50]
len_epoch: 100
 
Avg validation Stats after 10 global rounds:
Validation Loss : 0.1526486127132812
Validation Accuracy: 95.50% 

Validation loss decreased (0.157123 --> 0.152649).  Saving model ...

 | Global Training Round : 11 |

len idxs_epoch 71
idxs_epoch [8, 16, 12, 50, 50, 50, 50, 50, 21, 50, 16, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 21, 17, 50, 15, 50, 50, 50, 50, 16, 19, 50, 50, 9, 1, 50, 50, 20, 50, 50, 50, 50, 22, 50, 50, 50, 4, 50, 50, 50, 50, 50, 50, 2, 50, 9, 18, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 13, 10, 50, 6, 50, 50, 50, 50, 16, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 18, 18, 6, 19, 50, 50, 50, 50]
len_epoch: 100
 
Avg validation Stats after 11 global rounds:
Validation Loss : 0.1464854133940935
Validation Accuracy: 95.62% 

Validation loss decreased (0.152649 --> 0.146485).  Saving model ...

 | Global Training Round : 12 |

len idxs_epoch 71
idxs_epoch [50, 50, 50, 19, 50, 11, 18, 24, 50, 50, 50, 50, 50, 50, 50, 4, 50, 50, 9, 11, 50, 50, 50, 17, 50, 50, 17, 4, 15, 50, 50, 50, 50, 14, 50, 50, 16, 50, 50, 18, 50, 50, 50, 50, 19, 50, 7, 18, 50, 50, 50, 50, 12, 50, 50, 50, 6, 50, 50, 50, 50, 2, 15, 50, 11, 13, 50, 6, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 24, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 18, 4]
len_epoch: 100
 
Avg validation Stats after 12 global rounds:
Validation Loss : 0.1397665286652555
Validation Accuracy: 95.72% 

Validation loss decreased (0.146485 --> 0.139767).  Saving model ...

 | Global Training Round : 13 |

len idxs_epoch 71
idxs_epoch [50, 13, 50, 20, 50, 50, 50, 50, 16, 50, 50, 50, 50, 50, 50, 50, 50, 7, 19, 50, 50, 16, 18, 50, 12, 50, 50, 1, 50, 50, 50, 15, 50, 50, 50, 50, 50, 4, 25, 50, 50, 10, 9, 15, 50, 24, 50, 24, 50, 50, 50, 50, 50, 50, 50, 7, 10, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 13, 3, 25, 50, 50, 22, 50, 23, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 21, 10, 6]
len_epoch: 100
 
Avg validation Stats after 13 global rounds:
Validation Loss : 0.13622399364482587
Validation Accuracy: 95.97% 

Validation loss decreased (0.139767 --> 0.136224).  Saving model ...

 | Global Training Round : 14 |

len idxs_epoch 71
idxs_epoch [50, 10, 50, 50, 19, 50, 50, 50, 50, 3, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 6, 50, 4, 12, 50, 50, 50, 12, 19, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 3, 14, 22, 50, 50, 6, 50, 50, 50, 12, 50, 24, 10, 7, 14, 50, 50, 50, 50, 4, 50, 50, 50, 8, 50, 50, 14, 18, 50, 50, 50, 22, 50, 50, 50, 50, 50, 21, 7, 50, 50, 50, 25, 50, 50, 50, 11, 16, 50, 50, 50, 2, 50, 50, 50, 50, 7, 50]
len_epoch: 100
 
Avg validation Stats after 14 global rounds:
Validation Loss : 0.13145986276938124
Validation Accuracy: 96.13% 

Validation loss decreased (0.136224 --> 0.131460).  Saving model ...

 | Global Training Round : 15 |

len idxs_epoch 71
idxs_epoch [50, 50, 50, 50, 50, 2, 50, 50, 8, 50, 14, 50, 50, 50, 50, 3, 50, 4, 50, 50, 50, 1, 19, 50, 7, 50, 50, 50, 50, 10, 50, 21, 8, 50, 50, 50, 50, 50, 50, 50, 8, 19, 50, 50, 50, 20, 50, 50, 16, 50, 50, 50, 10, 50, 50, 6, 22, 50, 12, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 7, 50, 50, 12, 10, 50, 20, 50, 50, 50, 7, 18, 50, 50, 50, 50, 50, 50, 50, 2, 21, 50, 50, 24, 50, 50, 50]
len_epoch: 100
 
Avg validation Stats after 15 global rounds:
Validation Loss : 0.1270980440082203
Validation Accuracy: 96.33% 

Validation loss decreased (0.131460 --> 0.127098).  Saving model ...

 | Global Training Round : 16 |

len idxs_epoch 71
idxs_epoch [13, 12, 22, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 10, 50, 50, 50, 50, 50, 24, 50, 3, 50, 50, 17, 50, 50, 50, 3, 50, 1, 50, 50, 16, 2, 2, 18, 50, 50, 1, 50, 50, 50, 2, 50, 4, 50, 6, 50, 50, 50, 50, 50, 8, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 8, 50, 50, 21, 50, 50, 50, 50, 8, 50, 50, 50, 50, 8, 25, 4, 50, 50, 50, 50, 7]
len_epoch: 100
 
Avg validation Stats after 16 global rounds:
Validation Loss : 0.12460713366648639
Validation Accuracy: 96.40% 

Validation loss decreased (0.127098 --> 0.124607).  Saving model ...

 | Global Training Round : 17 |

len idxs_epoch 71
idxs_epoch [50, 7, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 6, 21, 50, 18, 50, 18, 50, 19, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 14, 15, 50, 50, 50, 50, 50, 50, 50, 19, 22, 50, 50, 5, 50, 50, 21, 50, 50, 50, 25, 50, 14, 50, 50, 50, 50, 9, 50, 21, 50, 50, 50, 50, 50, 50, 19, 50, 6, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 22, 25, 6, 2, 25, 6, 50, 24, 50, 50, 50, 50, 24, 13, 50, 50, 50, 50, 50]
len_epoch: 100
 
Avg validation Stats after 17 global rounds:
Validation Loss : 0.12259568356986533
Validation Accuracy: 96.40% 

Validation loss decreased (0.124607 --> 0.122596).  Saving model ...

 | Global Training Round : 18 |

len idxs_epoch 71
idxs_epoch [50, 50, 12, 22, 50, 2, 50, 50, 50, 50, 1, 50, 50, 50, 50, 50, 50, 50, 50, 7, 50, 50, 14, 50, 50, 50, 50, 12, 50, 9, 50, 18, 4, 50, 6, 50, 50, 50, 50, 18, 50, 50, 50, 1, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 8, 50, 16, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 20, 50, 22, 15, 10, 14, 50, 50, 50, 12, 9, 11, 50, 50, 50, 1, 50, 22, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 5, 13]
len_epoch: 100
 
Avg validation Stats after 18 global rounds:
Validation Loss : 0.12381736187123257
Validation Accuracy: 96.45% 

EarlyStopping counter: 1 out of 3

 | Global Training Round : 19 |

len idxs_epoch 71
idxs_epoch [50, 19, 14, 22, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 21, 50, 50, 50, 11, 24, 21, 50, 1, 17, 14, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 7, 50, 50, 3, 50, 25, 16, 50, 15, 14, 50, 50, 50, 50, 50, 8, 50, 50, 7, 22, 50, 11, 50, 50, 50, 50, 2, 50, 2, 50, 4, 50, 50, 24, 50, 50, 4, 24, 50, 50, 50, 50, 14]
len_epoch: 100
 
Avg validation Stats after 19 global rounds:
Validation Loss : 0.11943231873632792
Validation Accuracy: 96.40% 

Validation loss decreased (0.122596 --> 0.119432).  Saving model ...

 | Global Training Round : 20 |

len idxs_epoch 71
idxs_epoch [50, 50, 50, 1, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 1, 50, 50, 17, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 2, 50, 5, 50, 50, 25, 50, 50, 50, 10, 50, 24, 15, 19, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 8, 3, 50, 50, 50, 18, 14, 50, 18, 50, 50, 12, 50, 7, 50, 50, 10, 50, 50, 17, 10, 8, 50, 21, 50, 50, 50, 15, 50, 50, 12, 50, 50, 50, 50, 50]
len_epoch: 100
 
Avg validation Stats after 20 global rounds:
Validation Loss : 0.11526883336381254
Validation Accuracy: 96.52% 

Validation loss decreased (0.119432 --> 0.115269).  Saving model ...

 | Global Training Round : 21 |

len idxs_epoch 71
idxs_epoch [50, 21, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 10, 5, 22, 50, 7, 11, 50, 14, 50, 50, 50, 50, 50, 50, 50, 4, 3, 50, 15, 50, 19, 23, 50, 19, 4, 50, 50, 50, 14, 50, 19, 50, 50, 50, 50, 19, 21, 7, 50, 50, 50, 50, 50, 50, 50, 50, 11, 17, 13, 50, 15, 50, 50, 50, 50, 8, 50, 1, 50, 12, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50]
len_epoch: 100
 
Avg validation Stats after 21 global rounds:
Validation Loss : 0.11213528811353356
Validation Accuracy: 96.67% 

Validation loss decreased (0.115269 --> 0.112135).  Saving model ...

 | Global Training Round : 22 |

len idxs_epoch 71
idxs_epoch [50, 50, 13, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 14, 7, 50, 2, 50, 50, 50, 50, 50, 50, 9, 50, 50, 50, 14, 20, 16, 50, 50, 18, 3, 8, 50, 50, 50, 50, 6, 50, 19, 50, 50, 50, 50, 50, 22, 50, 19, 50, 50, 13, 50, 50, 50, 50, 50, 50, 21, 7, 50, 50, 21, 50, 50, 50, 50, 23, 50, 25, 50, 50, 50, 50, 50, 7, 50, 50, 11, 50, 7, 50, 50, 50, 20, 50, 15, 25, 50, 50]
len_epoch: 100
 
Avg validation Stats after 22 global rounds:
Validation Loss : 0.10923488319957599
Validation Accuracy: 96.82% 

Validation loss decreased (0.112135 --> 0.109235).  Saving model ...

 | Global Training Round : 23 |

len idxs_epoch 71
idxs_epoch [50, 14, 50, 5, 50, 50, 12, 50, 50, 8, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 17, 50, 50, 50, 13, 50, 50, 15, 50, 50, 50, 50, 50, 2, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 16, 16, 15, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 24, 10, 14, 9, 50, 50, 50, 3, 13, 9, 50, 50, 50, 3, 50, 9, 50, 50, 50, 19, 1, 22, 24, 50, 50, 14, 50, 12, 50, 24, 50, 50]
len_epoch: 100
 
Avg validation Stats after 23 global rounds:
Validation Loss : 0.1078336220017809
Validation Accuracy: 96.77% 

Validation loss decreased (0.109235 --> 0.107834).  Saving model ...

 | Global Training Round : 24 |

len idxs_epoch 71
idxs_epoch [50, 2, 50, 50, 50, 50, 50, 9, 10, 50, 50, 15, 25, 19, 50, 50, 50, 50, 1, 14, 50, 50, 50, 23, 20, 21, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 13, 12, 15, 3, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 2, 50, 50, 50, 7, 25, 50, 50, 50, 3, 20, 8, 50, 50, 50, 50, 9, 50, 20, 50, 50, 19, 16, 50, 50, 1, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 5, 50, 50]
len_epoch: 100
 
Avg validation Stats after 24 global rounds:
Validation Loss : 0.108031600004791
Validation Accuracy: 96.92% 

EarlyStopping counter: 1 out of 3

 | Global Training Round : 25 |

len idxs_epoch 71
idxs_epoch [50, 50, 50, 50, 24, 50, 50, 7, 50, 50, 5, 50, 50, 10, 16, 50, 50, 50, 13, 50, 7, 25, 1, 50, 16, 50, 50, 7, 14, 21, 50, 50, 50, 50, 20, 50, 50, 50, 3, 50, 50, 50, 50, 9, 50, 7, 50, 50, 50, 50, 12, 5, 50, 50, 50, 18, 11, 50, 50, 50, 50, 50, 16, 50, 50, 50, 50, 2, 10, 50, 50, 50, 50, 50, 50, 50, 50, 4, 50, 50, 5, 10, 50, 11, 50, 50, 50, 50, 50, 1, 50, 50, 50, 50, 50, 50, 3, 50, 50, 50]
len_epoch: 100
 
Avg validation Stats after 25 global rounds:
Validation Loss : 0.1048097506600079
Validation Accuracy: 97.02% 

Validation loss decreased (0.107834 --> 0.104810).  Saving model ...

 | Global Training Round : 26 |

len idxs_epoch 71
idxs_epoch [50, 50, 50, 5, 50, 50, 50, 50, 4, 1, 11, 50, 50, 50, 11, 50, 50, 50, 1, 50, 50, 50, 50, 5, 50, 17, 50, 8, 21, 50, 5, 22, 50, 50, 50, 50, 50, 3, 2, 15, 50, 50, 50, 5, 20, 50, 23, 50, 50, 50, 50, 50, 50, 22, 10, 50, 50, 50, 50, 50, 8, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 14, 50, 50, 50, 50, 50, 16, 50, 50, 50, 7, 50, 50, 50, 50, 15, 50, 50, 50, 11, 50, 5, 50, 50, 50, 9, 50, 50, 3]
len_epoch: 100
 
Avg validation Stats after 26 global rounds:
Validation Loss : 0.10486284663748098
Validation Accuracy: 96.95% 

EarlyStopping counter: 1 out of 3

 | Global Training Round : 27 |

len idxs_epoch 71
idxs_epoch [50, 10, 50, 50, 50, 50, 50, 50, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 4, 50, 50, 50, 50, 5, 50, 50, 50, 50, 50, 7, 11, 22, 50, 50, 50, 50, 50, 50, 16, 50, 14, 22, 17, 50, 2, 6, 1, 18, 50, 17, 13, 50, 50, 50, 50, 18, 50, 50, 50, 50, 21, 50, 10, 6, 11, 50, 10, 20, 50, 50, 50, 50, 50, 6, 50, 50, 50, 50, 50, 15, 24, 50, 50, 50, 50, 8, 50, 50, 50, 50, 50, 50, 20, 50, 12, 50, 50, 50]
len_epoch: 100
 
Avg validation Stats after 27 global rounds:
Validation Loss : 0.1028408622640964
Validation Accuracy: 96.98% 

Validation loss decreased (0.104810 --> 0.102841).  Saving model ...

 | Global Training Round : 28 |

len idxs_epoch 71
idxs_epoch [50, 9, 50, 50, 4, 23, 50, 24, 6, 50, 50, 50, 50, 10, 50, 50, 50, 50, 50, 3, 50, 7, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 16, 50, 50, 21, 18, 18, 50, 50, 50, 50, 50, 50, 50, 50, 16, 50, 50, 50, 50, 19, 6, 50, 50, 11, 50, 50, 8, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 8, 50, 50, 50, 1, 50, 50, 15, 50, 50, 50, 50, 17, 16, 25, 7, 15, 2, 50, 50, 50, 50, 18, 50, 20]
len_epoch: 100
 
Avg validation Stats after 28 global rounds:
Validation Loss : 0.10183535408959912
Validation Accuracy: 96.95% 

Validation loss decreased (0.102841 --> 0.101835).  Saving model ...

 | Global Training Round : 29 |

len idxs_epoch 71
idxs_epoch [50, 50, 50, 15, 50, 12, 50, 50, 50, 50, 50, 50, 50, 7, 50, 50, 50, 50, 50, 50, 50, 5, 50, 10, 50, 20, 50, 50, 50, 50, 50, 50, 9, 2, 50, 9, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 16, 50, 50, 50, 50, 50, 50, 50, 4, 9, 17, 50, 50, 15, 50, 50, 15, 50, 50, 16, 50, 50, 11, 50, 10, 50, 50, 50, 11, 20, 21, 50, 50, 50, 50, 11, 50, 50, 50, 21, 14, 50, 50, 50, 50, 50, 10, 5, 16, 50, 10, 24, 50]
len_epoch: 100
 
Avg validation Stats after 29 global rounds:
Validation Loss : 0.10048948246986608
Validation Accuracy: 97.07% 

Validation loss decreased (0.101835 --> 0.100489).  Saving model ...

 | Global Training Round : 30 |

len idxs_epoch 71
idxs_epoch [11, 50, 50, 19, 50, 50, 50, 17, 17, 50, 50, 12, 50, 7, 25, 24, 2, 50, 50, 18, 50, 50, 50, 50, 50, 9, 50, 50, 50, 1, 50, 50, 2, 50, 50, 14, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 4, 50, 50, 17, 22, 15, 18, 50, 50, 1, 50, 50, 50, 7, 9, 50, 50, 6, 14, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 3, 50, 50, 50, 50, 50, 50, 11]
len_epoch: 100
 
Avg validation Stats after 30 global rounds:
Validation Loss : 0.10021699898672091
Validation Accuracy: 97.03% 

Validation loss decreased (0.100489 --> 0.100217).  Saving model ...
precision: 0.9734904734253043
recall 0.9735124575663574
accuracy 0.9736
F1 score 0.9734665962941932
correct : 9736.0
total : 10000.0
test loss now: 0.08628057462606827
bnatch index: 79
 
 Results after 30 global rounds of training:
 Train loss:  [1.8528774102837433, 0.9264379447014915, 0.6152521342946805, 0.5027126372666967, 0.4265143225640026, 0.3862216246522785, 0.3389190939857681, 0.32544831835168103, 0.29776041260570113, 0.29087867148041013, 0.26274981242299833, 0.2560745665614665, 0.2396283361694106, 0.23202741514907183, 0.22745857002102862, 0.2258380225370826, 0.21270142920676458, 0.1978010646115863, 0.1958736863981876, 0.1964506719680956, 0.18732253634147375, 0.18567095695139002, 0.1823993217529301, 0.18158716709281883, 0.1810720981019053, 0.1765437222781072, 0.17061422673200505, 0.17096862485619915, 0.1615129792844975, 0.15233782284993921]
 Validation loss:  [1.0359273691177364, 0.41117312788590765, 0.28957753411913284, 0.24627836884697904, 0.21098625293700035, 0.19214852322064682, 0.17857619722168605, 0.1687859660927061, 0.1571225002568462, 0.1526486127132812, 0.1464854133940935, 0.1397665286652555, 0.13622399364482587, 0.13145986276938124, 0.1270980440082203, 0.12460713366648639, 0.12259568356986533, 0.12381736187123257, 0.11943231873632792, 0.11526883336381254, 0.11213528811353356, 0.10923488319957599, 0.1078336220017809, 0.108031600004791, 0.1048097506600079, 0.10486284663748098, 0.1028408622640964, 0.10183535408959912, 0.10048948246986608, 0.10021699898672091]
 Validation accuracy:  [83.7666666666666, 89.16666666666664, 91.68333333333338, 92.7333333333334, 93.7833333333334, 94.20000000000007, 94.70000000000007, 95.00000000000007, 95.25000000000006, 95.50000000000007, 95.61666666666675, 95.71666666666675, 95.96666666666675, 96.13333333333341, 96.3333333333334, 96.40000000000008, 96.40000000000008, 96.45000000000007, 96.40000000000008, 96.51666666666675, 96.66666666666674, 96.81666666666676, 96.76666666666675, 96.91666666666674, 97.01666666666674, 96.95000000000007, 96.9833333333334, 96.95000000000007, 97.06666666666673, 97.0333333333334]
 Test Accuracy: 97.36%
 Test loss: 0.09

 Total Run Time: 5688.0845
----------Experiment---------
Namespace(dataset='mnist', epoch=30, frac=0.2, gpu=None, iid=0, kernel_num=9, kernel_sizes='3,4,5', l_batch=128, l_epoch=50, lr=0.01, max_pool='True', method='fedavg', model='cnn', n_classes=10, n_equal=0, norm='batch_norm', num_channels=1, num_filters=32, num_users=100, optimizer='sgd', seed=0, stop=3, straggler_frac=0.9, user_type=1, verbose=1)
 Model : cnn

 Optimizer : sgd
 learning rate : 0.01
 Global Rounds : 30
 Federated settings
Dataset : IID
 Adaptive participation
Local batch size: 128
Local epochs: 50
straggler_frac: 0.9
len idxs_epoch 10

 | Global Training Round : 1 |

 
Avg validation Stats after 1 global rounds:
Validation Loss : 2.213544535875321
Validation Accuracy: 34.75% 

Validation loss decreased (inf --> 2.213545).  Saving model ...

 | Global Training Round : 2 |

 
Avg validation Stats after 2 global rounds:
Validation Loss : 1.9349584558010104
Validation Accuracy: 69.50% 

Validation loss decreased (2.213545 --> 1.934958).  Saving model ...

 | Global Training Round : 3 |

 
Avg validation Stats after 3 global rounds:
Validation Loss : 1.065921700716019
Validation Accuracy: 78.52% 

Validation loss decreased (1.934958 --> 1.065922).  Saving model ...

 | Global Training Round : 4 |

 
Avg validation Stats after 4 global rounds:
Validation Loss : 0.5985808591917159
Validation Accuracy: 84.93% 

Validation loss decreased (1.065922 --> 0.598581).  Saving model ...

 | Global Training Round : 5 |

 
Avg validation Stats after 5 global rounds:
Validation Loss : 0.453789715992287
Validation Accuracy: 87.62% 

Validation loss decreased (0.598581 --> 0.453790).  Saving model ...

 | Global Training Round : 6 |

 
Avg validation Stats after 6 global rounds:
Validation Loss : 0.39404738290607916
Validation Accuracy: 88.65% 

Validation loss decreased (0.453790 --> 0.394047).  Saving model ...

 | Global Training Round : 7 |

 
Avg validation Stats after 7 global rounds:
Validation Loss : 0.3535901195695624
Validation Accuracy: 89.75% 

Validation loss decreased (0.394047 --> 0.353590).  Saving model ...

 | Global Training Round : 8 |

 
Avg validation Stats after 8 global rounds:
Validation Loss : 0.32232653045188636
Validation Accuracy: 90.63% 

Validation loss decreased (0.353590 --> 0.322327).  Saving model ...

 | Global Training Round : 9 |

 
Avg validation Stats after 9 global rounds:
Validation Loss : 0.2995132591216824
Validation Accuracy: 91.12% 

Validation loss decreased (0.322327 --> 0.299513).  Saving model ...

 | Global Training Round : 10 |

 
Avg validation Stats after 10 global rounds:
Validation Loss : 0.2811953360019252
Validation Accuracy: 91.72% 

Validation loss decreased (0.299513 --> 0.281195).  Saving model ...

 | Global Training Round : 11 |

 
Avg validation Stats after 11 global rounds:
Validation Loss : 0.26416139470087363
Validation Accuracy: 92.37% 

Validation loss decreased (0.281195 --> 0.264161).  Saving model ...

 | Global Training Round : 12 |

 
Avg validation Stats after 12 global rounds:
Validation Loss : 0.25039134008018304
Validation Accuracy: 92.57% 

Validation loss decreased (0.264161 --> 0.250391).  Saving model ...

 | Global Training Round : 13 |

 
Avg validation Stats after 13 global rounds:
Validation Loss : 0.2373984687188641
Validation Accuracy: 92.92% 

Validation loss decreased (0.250391 --> 0.237398).  Saving model ...

 | Global Training Round : 14 |

 
Avg validation Stats after 14 global rounds:
Validation Loss : 0.22756885619880637
Validation Accuracy: 93.18% 

Validation loss decreased (0.237398 --> 0.227569).  Saving model ...

 | Global Training Round : 15 |

 
Avg validation Stats after 15 global rounds:
Validation Loss : 0.2179573837177595
Validation Accuracy: 93.50% 

Validation loss decreased (0.227569 --> 0.217957).  Saving model ...

 | Global Training Round : 16 |

 
Avg validation Stats after 16 global rounds:
Validation Loss : 0.20989611299638627
Validation Accuracy: 93.70% 

Validation loss decreased (0.217957 --> 0.209896).  Saving model ...

 | Global Training Round : 17 |

 
Avg validation Stats after 17 global rounds:
Validation Loss : 0.20282761952665168
Validation Accuracy: 93.98% 

Validation loss decreased (0.209896 --> 0.202828).  Saving model ...

 | Global Training Round : 18 |

 
Avg validation Stats after 18 global rounds:
Validation Loss : 0.19519601767364658
Validation Accuracy: 94.28% 

Validation loss decreased (0.202828 --> 0.195196).  Saving model ...

 | Global Training Round : 19 |

 
Avg validation Stats after 19 global rounds:
Validation Loss : 0.18890165248519047
Validation Accuracy: 94.53% 

Validation loss decreased (0.195196 --> 0.188902).  Saving model ...

 | Global Training Round : 20 |

 
Avg validation Stats after 20 global rounds:
Validation Loss : 0.1829299080812489
Validation Accuracy: 94.67% 

Validation loss decreased (0.188902 --> 0.182930).  Saving model ...

 | Global Training Round : 21 |

 
Avg validation Stats after 21 global rounds:
Validation Loss : 0.17844247213288328
Validation Accuracy: 94.80% 

Validation loss decreased (0.182930 --> 0.178442).  Saving model ...

 | Global Training Round : 22 |

 
Avg validation Stats after 22 global rounds:
Validation Loss : 0.1730275429871691
Validation Accuracy: 94.95% 

Validation loss decreased (0.178442 --> 0.173028).  Saving model ...

 | Global Training Round : 23 |

 
Avg validation Stats after 23 global rounds:
Validation Loss : 0.16882021222656474
Validation Accuracy: 95.00% 

Validation loss decreased (0.173028 --> 0.168820).  Saving model ...

 | Global Training Round : 24 |

 
Avg validation Stats after 24 global rounds:
Validation Loss : 0.16443325987286517
Validation Accuracy: 95.07% 

Validation loss decreased (0.168820 --> 0.164433).  Saving model ...

 | Global Training Round : 25 |

 
Avg validation Stats after 25 global rounds:
Validation Loss : 0.1603733487667196
Validation Accuracy: 95.10% 

Validation loss decreased (0.164433 --> 0.160373).  Saving model ...

 | Global Training Round : 26 |

 
Avg validation Stats after 26 global rounds:
Validation Loss : 0.15705493437683615
Validation Accuracy: 95.28% 

Validation loss decreased (0.160373 --> 0.157055).  Saving model ...

 | Global Training Round : 27 |

 
Avg validation Stats after 27 global rounds:
Validation Loss : 0.15386046185803567
Validation Accuracy: 95.37% 

Validation loss decreased (0.157055 --> 0.153860).  Saving model ...

 | Global Training Round : 28 |

 
Avg validation Stats after 28 global rounds:
Validation Loss : 0.15044042557967618
Validation Accuracy: 95.43% 

Validation loss decreased (0.153860 --> 0.150440).  Saving model ...

 | Global Training Round : 29 |

 
Avg validation Stats after 29 global rounds:
Validation Loss : 0.1471248398809039
Validation Accuracy: 95.52% 

Validation loss decreased (0.150440 --> 0.147125).  Saving model ...

 | Global Training Round : 30 |

 
Avg validation Stats after 30 global rounds:
Validation Loss : 0.14452316371818597
Validation Accuracy: 95.58% 

Validation loss decreased (0.147125 --> 0.144523).  Saving model ...
precision: 0.9587643740532661
recall 0.9589937194735224
accuracy 0.9592
F1 score 0.95881528172517
correct : 9592.0
total : 10000.0
test loss now: 0.13184991472436092
bnatch index: 79
 
 Results after 30 global rounds of training:
 
 Results after 30 global rounds of training:
 Train loss:  [2.271478916070362, 2.1429889225344807, 1.6881430243764732, 1.1266297234430893, 0.857980520414822, 0.7315096008376031, 0.6656116655215836, 0.6130296399786118, 0.5655892399120024, 0.5422382836597768, 0.5099390356152322, 0.48953855052355144, 0.4637779711356516, 0.45110855918030346, 0.4323566753147268, 0.41688675234261396, 0.40690055489451327, 0.3931643763365414, 0.37993048823220393, 0.36807708937662065, 0.3583729623123816, 0.34846569127128896, 0.33909381723587406, 0.332447863301347, 0.32376294935122396, 0.3169064277484608, 0.30806397730103097, 0.3038571048406433, 0.297444173913007, 0.2914241430980211]
 Validation loss:  [2.213544535875321, 1.9349584558010104, 1.065921700716019, 0.5985808591917159, 0.453789715992287, 0.39404738290607916, 0.3535901195695624, 0.32232653045188636, 0.2995132591216824, 0.2811953360019252, 0.26416139470087363, 0.25039134008018304, 0.2373984687188641, 0.22756885619880637, 0.2179573837177595, 0.20989611299638627, 0.20282761952665168, 0.19519601767364658, 0.18890165248519047, 0.1829299080812489, 0.17844247213288328, 0.1730275429871691, 0.16882021222656474, 0.16443325987286517, 0.1603733487667196, 0.15705493437683615, 0.15386046185803567, 0.15044042557967618, 0.1471248398809039, 0.14452316371818597]
 Validation accuracy:  [34.75000000000001, 69.5, 78.51666666666664, 84.93333333333332, 87.61666666666663, 88.64999999999998, 89.74999999999999, 90.63333333333335, 91.1166666666667, 91.71666666666674, 92.36666666666672, 92.56666666666673, 92.91666666666674, 93.18333333333344, 93.5000000000001, 93.70000000000012, 93.98333333333343, 94.28333333333343, 94.53333333333343, 94.66666666666676, 94.80000000000008, 94.95000000000007, 95.00000000000007, 95.06666666666673, 95.10000000000008, 95.28333333333342, 95.36666666666675, 95.43333333333342, 95.51666666666677, 95.58333333333343]
 Test Accuracy: 95.92%
 Test loss: 0.13

 Total Run Time: 5678.9131
----------Experiment---------
Namespace(dataset='mnist', epoch=30, frac=0.2, gpu=None, iid=0, kernel_num=9, kernel_sizes='3,4,5', l_batch=128, l_epoch=50, lr=0.01, max_pool='True', method='fedavg', model='cnn', n_classes=10, n_equal=0, norm='batch_norm', num_channels=1, num_filters=32, num_users=100, optimizer='sgd', seed=0, stop=3, straggler_frac=0.7, user_type=1, verbose=1)
 Model : cnn

 Optimizer : sgd
 learning rate : 0.01
 Global Rounds : 30
 Federated settings
Dataset : IID
 Adaptive participation
Local batch size: 128
Local epochs: 50
straggler_frac: 0.7
len idxs_epoch 31

 | Global Training Round : 1 |

 
Avg validation Stats after 1 global rounds:
Validation Loss : 1.9359958466291423
Validation Accuracy: 65.63% 

Validation loss decreased (inf --> 1.935996).  Saving model ...

 | Global Training Round : 2 |

 
Avg validation Stats after 2 global rounds:
Validation Loss : 0.8402939049154518
Validation Accuracy: 82.43% 

Validation loss decreased (1.935996 --> 0.840294).  Saving model ...

 | Global Training Round : 3 |

 
Avg validation Stats after 3 global rounds:
Validation Loss : 0.4595825318023563
Validation Accuracy: 88.08% 

Validation loss decreased (0.840294 --> 0.459583).  Saving model ...

 | Global Training Round : 4 |

 
Avg validation Stats after 4 global rounds:
Validation Loss : 0.3291677775913849
Validation Accuracy: 91.08% 

Validation loss decreased (0.459583 --> 0.329168).  Saving model ...

 | Global Training Round : 5 |

 
Avg validation Stats after 5 global rounds:
Validation Loss : 0.27161484345048675
Validation Accuracy: 92.25% 

Validation loss decreased (0.329168 --> 0.271615).  Saving model ...

 | Global Training Round : 6 |

 
Avg validation Stats after 6 global rounds:
Validation Loss : 0.23594399724225518
Validation Accuracy: 93.17% 

Validation loss decreased (0.271615 --> 0.235944).  Saving model ...

 | Global Training Round : 7 |

 
Avg validation Stats after 7 global rounds:
Validation Loss : 0.21446502174995835
Validation Accuracy: 93.67% 

Validation loss decreased (0.235944 --> 0.214465).  Saving model ...

 | Global Training Round : 8 |

 
Avg validation Stats after 8 global rounds:
Validation Loss : 0.19717318421992241
Validation Accuracy: 94.13% 

Validation loss decreased (0.214465 --> 0.197173).  Saving model ...

 | Global Training Round : 9 |

 
Avg validation Stats after 9 global rounds:
Validation Loss : 0.183015649093024
Validation Accuracy: 94.47% 

Validation loss decreased (0.197173 --> 0.183016).  Saving model ...

 | Global Training Round : 10 |

 
Avg validation Stats after 10 global rounds:
Validation Loss : 0.1729245792789151
Validation Accuracy: 94.70% 

Validation loss decreased (0.183016 --> 0.172925).  Saving model ...

 | Global Training Round : 11 |

 
Avg validation Stats after 11 global rounds:
Validation Loss : 0.16434443043713692
Validation Accuracy: 94.85% 

Validation loss decreased (0.172925 --> 0.164344).  Saving model ...

 | Global Training Round : 12 |

 
Avg validation Stats after 12 global rounds:
Validation Loss : 0.15697017525837867
Validation Accuracy: 95.18% 

Validation loss decreased (0.164344 --> 0.156970).  Saving model ...

 | Global Training Round : 13 |

 
Avg validation Stats after 13 global rounds:
Validation Loss : 0.15076061506867697
Validation Accuracy: 95.32% 

Validation loss decreased (0.156970 --> 0.150761).  Saving model ...

 | Global Training Round : 14 |

 
Avg validation Stats after 14 global rounds:
Validation Loss : 0.14510363465193957
Validation Accuracy: 95.50% 

Validation loss decreased (0.150761 --> 0.145104).  Saving model ...

 | Global Training Round : 15 |

 
Avg validation Stats after 15 global rounds:
Validation Loss : 0.13996049764435894
Validation Accuracy: 95.70% 

Validation loss decreased (0.145104 --> 0.139960).  Saving model ...

 | Global Training Round : 16 |

 
Avg validation Stats after 16 global rounds:
Validation Loss : 0.1360999833650057
Validation Accuracy: 95.72% 

Validation loss decreased (0.139960 --> 0.136100).  Saving model ...

 | Global Training Round : 17 |

 
Avg validation Stats after 17 global rounds:
Validation Loss : 0.13185784969179076
Validation Accuracy: 95.90% 

Validation loss decreased (0.136100 --> 0.131858).  Saving model ...

 | Global Training Round : 18 |

 
Avg validation Stats after 18 global rounds:
Validation Loss : 0.12877187256657996
Validation Accuracy: 96.03% 

Validation loss decreased (0.131858 --> 0.128772).  Saving model ...

 | Global Training Round : 19 |

 
Avg validation Stats after 19 global rounds:
Validation Loss : 0.12539352621955555
Validation Accuracy: 96.13% 

Validation loss decreased (0.128772 --> 0.125394).  Saving model ...

 | Global Training Round : 20 |

 
Avg validation Stats after 20 global rounds:
Validation Loss : 0.12195630492827879
Validation Accuracy: 96.27% 

Validation loss decreased (0.125394 --> 0.121956).  Saving model ...

 | Global Training Round : 21 |

 
Avg validation Stats after 21 global rounds:
Validation Loss : 0.11916276395287603
Validation Accuracy: 96.38% 

Validation loss decreased (0.121956 --> 0.119163).  Saving model ...

 | Global Training Round : 22 |

 
Avg validation Stats after 22 global rounds:
Validation Loss : 0.11669750034024588
Validation Accuracy: 96.42% 

Validation loss decreased (0.119163 --> 0.116698).  Saving model ...

 | Global Training Round : 23 |

 
Avg validation Stats after 23 global rounds:
Validation Loss : 0.11416375005647023
Validation Accuracy: 96.45% 

Validation loss decreased (0.116698 --> 0.114164).  Saving model ...

 | Global Training Round : 24 |

 
Avg validation Stats after 24 global rounds:
Validation Loss : 0.11221537028076636
Validation Accuracy: 96.55% 

Validation loss decreased (0.114164 --> 0.112215).  Saving model ...

 | Global Training Round : 25 |

 
Avg validation Stats after 25 global rounds:
Validation Loss : 0.11019140104856069
Validation Accuracy: 96.60% 

Validation loss decreased (0.112215 --> 0.110191).  Saving model ...

 | Global Training Round : 26 |

 
Avg validation Stats after 26 global rounds:
Validation Loss : 0.10803422234769179
Validation Accuracy: 96.67% 

Validation loss decreased (0.110191 --> 0.108034).  Saving model ...

 | Global Training Round : 27 |

 
Avg validation Stats after 27 global rounds:
Validation Loss : 0.10655901795332143
Validation Accuracy: 96.70% 

Validation loss decreased (0.108034 --> 0.106559).  Saving model ...

 | Global Training Round : 28 |

 
Avg validation Stats after 28 global rounds:
Validation Loss : 0.10522810128005813
Validation Accuracy: 96.82% 

Validation loss decreased (0.106559 --> 0.105228).  Saving model ...

 | Global Training Round : 29 |

 
Avg validation Stats after 29 global rounds:
Validation Loss : 0.10347830490736167
Validation Accuracy: 96.93% 

Validation loss decreased (0.105228 --> 0.103478).  Saving model ...

 | Global Training Round : 30 |

 
Avg validation Stats after 30 global rounds:
Validation Loss : 0.10197491571767976
Validation Accuracy: 96.98% 

Validation loss decreased (0.103478 --> 0.101975).  Saving model ...
precision: 0.9724460702624892
recall 0.9723662577783093
accuracy 0.9725
F1 score 0.972376032790671
correct : 9725.0
total : 10000.0
test loss now: 0.08943664444878674
bnatch index: 79
 
 Results after 30 global rounds of training:
 
 Results after 30 global rounds of training:
 Train loss:  [2.1553360775714387, 1.5625729155697727, 0.9536838432236497, 0.6859605799693462, 0.5529767372276956, 0.4814260124996673, 0.4290932762500228, 0.38921745350068165, 0.3637096020020955, 0.3399880046254168, 0.32089504162643523, 0.30171034235071015, 0.29214152145314987, 0.285675255993585, 0.2732227550944803, 0.2650035370950473, 0.2584459513173909, 0.2520022582982421, 0.24301342732298817, 0.24120501666493968, 0.2348491534761684, 0.2301328340513052, 0.22301167004493358, 0.21969768965234707, 0.21480943739555827, 0.2120088280364573, 0.20834828265408023, 0.2020019206171485, 0.19965003501205728, 0.1989781168138823]
 Validation loss:  [1.9359958466291423, 0.8402939049154518, 0.4595825318023563, 0.3291677775913849, 0.27161484345048675, 0.23594399724225518, 0.21446502174995835, 0.19717318421992241, 0.183015649093024, 0.1729245792789151, 0.16434443043713692, 0.15697017525837867, 0.15076061506867697, 0.14510363465193957, 0.13996049764435894, 0.1360999833650057, 0.13185784969179076, 0.12877187256657996, 0.12539352621955555, 0.12195630492827879, 0.11916276395287603, 0.11669750034024588, 0.11416375005647023, 0.11221537028076636, 0.11019140104856069, 0.10803422234769179, 0.10655901795332143, 0.10522810128005813, 0.10347830490736167, 0.10197491571767976]
 Validation accuracy:  [65.63333333333331, 82.4333333333333, 88.08333333333333, 91.08333333333333, 92.25000000000004, 93.16666666666674, 93.66666666666676, 94.13333333333343, 94.46666666666674, 94.70000000000009, 94.85000000000008, 95.18333333333344, 95.31666666666676, 95.50000000000011, 95.70000000000012, 95.71666666666678, 95.9000000000001, 96.03333333333345, 96.13333333333345, 96.26666666666678, 96.38333333333344, 96.41666666666677, 96.45000000000012, 96.55000000000011, 96.60000000000011, 96.66666666666677, 96.7000000000001, 96.81666666666678, 96.93333333333344, 96.98333333333343]
 Test Accuracy: 97.25%
 Test loss: 0.09

 Total Run Time: 8659.9684
